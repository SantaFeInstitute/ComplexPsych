<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Complex systems research in Psychology - 4&nbsp; Building dynamic system models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch5n.html" rel="next">
<link href="./ch3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch4n.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Building dynamic system models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./sfi_cover.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Complex systems research in Psychology</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/SantaFeInstitute/ComplexPsych/tree/master" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Complex-systems-research-in-Psychology.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prologue</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chaos and unpredictability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Transitions in complex systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4n.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Building dynamic system models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5n.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Self-organization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Psychological Network Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sociophysics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Epilogue</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-Introduction-ch4n" id="toc-sec-Introduction-ch4n" class="nav-link active" data-scroll-target="#sec-Introduction-ch4n"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#sec-Basic-concepts" id="toc-sec-Basic-concepts" class="nav-link" data-scroll-target="#sec-Basic-concepts"><span class="header-section-number">4.2</span> Basic concepts</a>
  <ul>
  <li><a href="#sec-Back-to-the-logistic-equation" id="toc-sec-Back-to-the-logistic-equation" class="nav-link" data-scroll-target="#sec-Back-to-the-logistic-equation"><span class="header-section-number">4.2.1</span> Back to the logistic equation</a></li>
  <li><a href="#sec-The-LotkaVolterra-models" id="toc-sec-The-LotkaVolterra-models" class="nav-link" data-scroll-target="#sec-The-LotkaVolterra-models"><span class="header-section-number">4.2.2</span> The Lotka—Volterra models</a></li>
  <li><a href="#sec-Fitting-models-stochasticity-versus-noise" id="toc-sec-Fitting-models-stochasticity-versus-noise" class="nav-link" data-scroll-target="#sec-Fitting-models-stochasticity-versus-noise"><span class="header-section-number">4.2.3</span> Fitting models: Stochasticity versus noise</a></li>
  <li><a href="#sec-Back-to-the-cusp" id="toc-sec-Back-to-the-cusp" class="nav-link" data-scroll-target="#sec-Back-to-the-cusp"><span class="header-section-number">4.2.4</span> Back to the cusp</a></li>
  <li><a href="#sec-Bifurcation-analysis" id="toc-sec-Bifurcation-analysis" class="nav-link" data-scroll-target="#sec-Bifurcation-analysis"><span class="header-section-number">4.2.5</span> Bifurcation analysis</a></li>
  <li><a href="#sec-Spruce-Budworm-outbreak-model" id="toc-sec-Spruce-Budworm-outbreak-model" class="nav-link" data-scroll-target="#sec-Spruce-Budworm-outbreak-model"><span class="header-section-number">4.2.6</span> Spruce budworm outbreak model</a></li>
  <li><a href="#sec-Evaluation-of-ecological-modelling" id="toc-sec-Evaluation-of-ecological-modelling" class="nav-link" data-scroll-target="#sec-Evaluation-of-ecological-modelling"><span class="header-section-number">4.2.7</span> Evaluation of ecological modeling</a></li>
  </ul></li>
  <li><a href="#sec-Psychological-models" id="toc-sec-Psychological-models" class="nav-link" data-scroll-target="#sec-Psychological-models"><span class="header-section-number">4.3</span> Psychological models</a>
  <ul>
  <li><a href="#sec-Response-time-models" id="toc-sec-Response-time-models" class="nav-link" data-scroll-target="#sec-Response-time-models"><span class="header-section-number">4.3.1</span> Response time models</a></li>
  <li><a href="#sec-Dyadic-models" id="toc-sec-Dyadic-models" class="nav-link" data-scroll-target="#sec-Dyadic-models"><span class="header-section-number">4.3.2</span> Dyadic models</a>
  <ul>
  <li><a href="#sec-Romeo-and-Juliet" id="toc-sec-Romeo-and-Juliet" class="nav-link" data-scroll-target="#sec-Romeo-and-Juliet"><span class="header-section-number">4.3.2.1</span> Romeo and Juliet</a></li>
  <li><a href="#sec-The-mathematics-of-marriage" id="toc-sec-The-mathematics-of-marriage" class="nav-link" data-scroll-target="#sec-The-mathematics-of-marriage"><span class="header-section-number">4.3.2.2</span> The mathematics of marriage</a></li>
  </ul></li>
  <li><a href="#sec-The-van-Geert-models" id="toc-sec-The-van-Geert-models" class="nav-link" data-scroll-target="#sec-The-van-Geert-models"><span class="header-section-number">4.3.3</span> The van Geert models</a></li>
  <li><a href="#sec-The-Polya-Urn-model-of-the-third-source" id="toc-sec-The-Polya-Urn-model-of-the-third-source" class="nav-link" data-scroll-target="#sec-The-Polya-Urn-model-of-the-third-source"><span class="header-section-number">4.3.4</span> The Pólya urn model of the third source</a></li>
  <li><a href="#sec-The-panic-model" id="toc-sec-The-panic-model" class="nav-link" data-scroll-target="#sec-The-panic-model"><span class="header-section-number">4.3.5</span> The panic model</a></li>
  <li><a href="#sec-Neural-models-van-der-Pol-and-different-time-scales" id="toc-sec-Neural-models-van-der-Pol-and-different-time-scales" class="nav-link" data-scroll-target="#sec-Neural-models-van-der-Pol-and-different-time-scales"><span class="header-section-number">4.3.6</span> Neural models: Van der Pol and different time scales</a></li>
  <li><a href="#sec-Analogical-modeling-Budworms-and-Beers" id="toc-sec-Analogical-modeling-Budworms-and-Beers" class="nav-link" data-scroll-target="#sec-Analogical-modeling-Budworms-and-Beers"><span class="header-section-number">4.3.7</span> Analogical modeling: Budworms and beers</a></li>
  <li><a href="#sec-Cascading-transitions-in-multifigure-multistable-perception" id="toc-sec-Cascading-transitions-in-multifigure-multistable-perception" class="nav-link" data-scroll-target="#sec-Cascading-transitions-in-multifigure-multistable-perception"><span class="header-section-number">4.3.8</span> Cascading transitions in multifigure multistable perception</a>
  <ul>
  <li><a href="#sec-Interacting-cusps" id="toc-sec-Interacting-cusps" class="nav-link" data-scroll-target="#sec-Interacting-cusps"><span class="header-section-number">4.3.8.1</span> Interacting cusps</a></li>
  <li><a href="#sec-Application-to-perception" id="toc-sec-Application-to-perception" class="nav-link" data-scroll-target="#sec-Application-to-perception"><span class="header-section-number">4.3.8.2</span> Application to perception</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-Causal-loop-diagrams" id="toc-sec-Causal-loop-diagrams" class="nav-link" data-scroll-target="#sec-Causal-loop-diagrams"><span class="header-section-number">4.4</span> Causal-loop diagrams</a></li>
  <li><a href="#sec-Closing-Remarks" id="toc-sec-Closing-Remarks" class="nav-link" data-scroll-target="#sec-Closing-Remarks"><span class="header-section-number">4.5</span> Closing remarks</a></li>
  <li><a href="#sec-Exercises-ch4n" id="toc-sec-Exercises-ch4n" class="nav-link" data-scroll-target="#sec-Exercises-ch4n"><span class="header-section-number">4.6</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-ch4n" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Building dynamic system models</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-Introduction-ch4n" class="level2 page-columns page-full" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-Introduction-ch4n"><span class="header-section-number">4.1</span> Introduction</h2>
<p>Suppose you are in a bar in Amsterdam and someone asks if you would like another beer. The number of drinks you have already had will probably influence your decision. Perhaps your self-control, whatever it may be, kicks in and you refuse, even though the alcohol already in your system may be interfering with that self-control. Or you may have reached your limit and simply collapse. In this chapter, we will see how such a decision-making process can be modeled using nonlinear differential equations.</p>
<div class="page-columns page-full"><p>This form of modeling is often called nonlinear dynamical systems theory (NLDST), another branch of the complex-systems approach.  We saw examples of nonlinear dynamical system models in earlier chapters. The logistic map is an example of a discrete-time nonlinear dynamical model defined as a difference equation. The catastrophe models are also dynamical systems governed by a potential function. In Chapter 3, <a href="ch3.html#sec-Building-catastrophe-models" class="quarto-xref"><span>Section 3.4</span></a>, I made a distinction between phenomenological modeling (assuming the cusp) and mechanistic modeling (deriving the cusp from first principles). Here we will focus on the more mechanistic construction of dynamical system models.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">A nonlinear dynamical system is one in which the change of system variables over time is governed by nonlinear equations, resulting in complex behavior such as chaos and bifurcations.</span></div></div>
<p>In psychology, following the principle of parsimony (Occam’s razor), we must start with simple models. We don’t have many first principles to start with, and our data are often limited, making model testing difficult. But we can learn a lot from other disciplines. Nonlinear dynamical systems have been developed in all the natural sciences, but my main inspiration comes from mathematical biology, especially ecological modeling <span class="citation" data-cites="murray1989">(<a href="references.html#ref-murray1989" role="doc-biblioref">Murray 1989</a>)</span>. Mathematical psychology is generally less developed than mathematical biology, but this depends somewhat on the subfield. In areas such as neural modeling, speeded-decision making, memory, choice, and psychometrics, there are advanced models, and I will provide some examples later in this chapter.</p>
<p>I will first present a basic overview of dynamical systems modeling in other sciences. Then I will discuss applications in psychology. I refer to more advanced sources when necessary. I recommend the book by <span class="citation" data-cites="gottmanMathematicsMarriageDynamic2002">Gottman et al. (<a href="references.html#ref-gottmanMathematicsMarriageDynamic2002" role="doc-biblioref">2002</a>)</span> for its clear and basic explanation of the mathematical aspects of dynamical systems modeling. Strogatz’s online lectures on nonlinear dynamics and chaos and his book <span class="citation" data-cites="strogatzNonlinearDynamicsChaos2018">(<a href="references.html#ref-strogatzNonlinearDynamicsChaos2018" role="doc-biblioref">2018</a>)</span> are very helpful. Murray’s book <span class="citation" data-cites="murrayMathematicalBiology2002">(<a href="references.html#ref-murrayMathematicalBiology2002" role="doc-biblioref">2002</a>)</span> on mathematical biology is also highly recommended. Meadows’s <em>Thinking in Systems</em> <span class="citation" data-cites="meadowsThinkingSystemsPrimer2008">(<a href="references.html#ref-meadowsThinkingSystemsPrimer2008" role="doc-biblioref">2008</a>)</span> offers a basic introduction.</p>
<p>This chapter will be hands-on again. We will use the Grind package in R to simulate dynamical systems models. Grind <span class="citation" data-cites="deboerSimplePhasePlane2018">(<a href="references.html#ref-deboerSimplePhasePlane2018" role="doc-biblioref">de Boer 2018</a>)</span> is based on the R packages deSolve and rootSolve <span class="citation" data-cites="soetaert2010">(<a href="references.html#ref-soetaert2010" role="doc-biblioref">Soetaert, Petzoldt, and Setzer 2010</a>)</span>. It facilitates numerical integration, phase plane analysis, and stability analysis of steady states.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>At the end of the chapter, I will introduce causal-loop diagrams and an open-source tool, Insightmaker, that makes it easy to create causal-loop diagrams. We will also use Insightmaker to simulate dynamical systems models, for which I will provide some examples.</p>
</section>
<section id="sec-Basic-concepts" class="level2 page-columns page-full" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-Basic-concepts"><span class="header-section-number">4.2</span> Basic concepts</h2>
<section id="sec-Back-to-the-logistic-equation" class="level3 page-columns page-full" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="sec-Back-to-the-logistic-equation"><span class="header-section-number">4.2.1</span> Back to the logistic equation</h3>
<div class="page-columns page-full"><p>We saw the logistic equation in the form of the logistic map (<a href="ch2.html#sec-The-population-growth-of-rabbits" class="quarto-xref"><span>Section 2.2</span></a>), where time progressed in discrete steps. The logistic map is a difference equation, <span class="math inline">\(X_{t + 1} = f(X_{t})\)</span>, but in this chapter we will focus on differential equations in continuous time. We will limit ourselves to ordinary differential equations (ODEs).  The ODE for logistic growth<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> is:</p><div class="no-row-height column-margin column-container"><span class="margin-aside">In ordinary differential equations, we take the derivatives with respect to only one variable.</span></div></div>
<p><span id="eq-ch4n-1-old-21"><span class="math display">\[
\frac{dX}{dt} = rX(1 - X).
\tag{4.1}\]</span></span></p>
<p>The change in <span class="math inline">\(X\)</span> is a function of <span class="math inline">\(X\)</span> itself. The exponential growth term <span class="math inline">\(rX\)</span> dominates when <span class="math inline">\(X\)</span> is close to 0, but the growth levels off as <span class="math inline">\(X\)</span> approaches 1. A solution to this equation expresses <span class="math inline">\(X_{t}\)</span> as a function of the initial state <span class="math inline">\(X_{0}\)</span>. In simple cases we can do this using the math we learned in high school. For exponential growth <span class="math inline">\(dX/dt = rX\)</span>, this is the derivation:</p>
<table class="table">
<colgroup>
<col style="width: 60%">
<col style="width: 39%">
</colgroup>
<tbody>
<tr class="odd">
<td><p><span class="math inline">\(\frac{dX}{dt} = rX\)</span></p>
<p><span class="math inline">\(\frac{dX}{X} = rdt\)</span></p></td>
<td>by separation of variables</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\int_{}^{}\frac{dX}{X} = \int_{}^{}{rdt}\)</span></td>
<td>integrate</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\ln X = rt + C\)</span></td>
<td>assuming <span class="math inline">\(X \geq 0\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(X = e^{rt + C} = e^{C}e^{rt}\)</span></td>
<td>by taking the exponent</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X_{0} = e^{C}e^{r0} \Longrightarrow X_{0} = e^{C}\)</span></td>
<td>compute the integration constant</td>
</tr>
</tbody>
</table>
<p><span id="eq-ch4n-2-old-22"><span class="math display">\[
\Longrightarrow X_{t} = {X_{0}e}^{rt}.
\tag{4.2}\]</span></span></p>
<p>But for more complex models, such an analytical solution is out of scope and numerical solutions (by simulation) are required. This is not the preferred choice. These simulations can be slow, they may accumulate rounding errors, and it can be difficult to search the entire parameter space, especially when multiple parameters are involved.</p>
<p>The naive implementation of differential equations in R is risky. This would involve a for loop:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x0 <span class="ot">&lt;-</span> .<span class="dv">1</span> <span class="co"># initial value</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="co"># growth rate</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> .<span class="dv">00001</span> <span class="co"># time step in simulation</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># Nt, time we want to know the value of x</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>timesteps <span class="ot">&lt;-</span> t<span class="sc">/</span>dt <span class="co"># required time steps given t and dt</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>timesteps) <span class="co"># note the 2 to use the starting value</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>] <span class="sc">+</span> r <span class="sc">*</span> x[i<span class="dv">-1</span>] <span class="sc">*</span> dt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>x0 <span class="sc">*</span> <span class="fu">exp</span>(r <span class="sc">*</span> timesteps <span class="sc">*</span> dt) <span class="co"># analytical solution</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>x[timesteps] <span class="co"># compare</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>timesteps <span class="co"># length of simulation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where <span class="math inline">\(dt\)</span> must be chosen by hand. If you test some values of <span class="math inline">\(dt\)</span>, you will see that a value too high (.5) leads to a solution (<code>x[timesteps]</code>) that is different from the analytical solution. But if we set <span class="math inline">\(dt\)</span> very low (.00001), it takes unnecessarily long.</p>
<div class="page-columns page-full"><p>This is why we use solvers, numerical methods for ordinary differential equations.  We will use the R package Grind, although many other methods are available in R. One could also directly use the R packages deSolve and rootSolve by <span class="citation" data-cites="soetaert2010">Soetaert, Petzoldt, and Setzer (<a href="references.html#ref-soetaert2010" role="doc-biblioref">2010</a>)</span>, on which the Grind package is based. Grind has to be installed from GitHub using:</p><div class="no-row-height column-margin column-container"><span class="margin-aside">Solvers are specialized algorithms designed to numerically approximate solutions to ODEs and handle the complexities of integrating these equations over time to predict the evolution of system states under different initial conditions and parameters.</span></div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"hansschepers/grindr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The packages required are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rootSolve)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FME)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Grind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code consists of defining the model, the parameters <span class="math inline">\(p\)</span>, and the initial values <span class="math inline">\(s\)</span>. Main functions are <code>run()</code>, <code>plane()</code>, <code>newton()</code>, <code>continue()</code>, and <code>fit()</code>. They will be introduced using examples. With <code>run()</code> we generate a time series for the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    dX <span class="ot">&lt;-</span> r <span class="sc">*</span> X <span class="co"># the exponential model</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dX)))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> .<span class="dv">5</span>) <span class="co"># parameter r</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">X =</span> .<span class="dv">1</span>) <span class="co"># initial value</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">tmax =</span> <span class="dv">5</span>) <span class="co"># run until t = 5, numerical solution</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>s[<span class="st">'X'</span>] <span class="sc">*</span> <span class="fu">exp</span>(p[<span class="st">'r'</span>] <span class="sc">*</span> <span class="dv">5</span>) <span class="co"># compare with analytical solution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We don’t have to worry about time steps anymore, and the numerical and analytical solutions converge. This is of course a trivial use of an ODE solver, but much more can be done.</p>
<p>In analyzing the behavior of a dynamical system, first we want to know what the equilibria <span class="math inline">\(X^{*}\)</span> are<em>.</em> To do this, we need to set the time derivative equal to 0, <span class="math inline">\(dX/dt = 0\)</span>. For the exponential function, this is simply <span class="math inline">\(rX = 0\)</span>, that is, when <span class="math inline">\(X\)</span> is 0. Second, we want to determine whether these equilibria are stable or unstable. Whether <span class="math inline">\(X^{*}=0\)</span> is stable can be determined by checking the second derivative in <span class="math inline">\(X^{*}\)</span>. If this derivative is less than 0, then the fixed point is stable. The second derivative is <span class="math inline">\(r\)</span>, so <span class="math inline">\(X^{*} = 0\)</span> is an unstable fixed point whenever <span class="math inline">\(r &gt; 0\)</span> and stable whenever <span class="math inline">\(r &lt; 0\)</span>. You can check this in Grind by using<span class="math inline">\(\ r\)</span> values of -.1 and .1, and start values equal to or just above or below 0.</p>
<p>For <a href="#eq-ch4n-1-old-21" class="quarto-xref">equation&nbsp;<span>4.1</span></a>, the logistic function, we also want to know the equilibria, the stable and unstable fixed points. To do so we follow the same steps as for the exponential function (see exercises).</p>
<p>The continuous-time implementation of the logistic function is somewhat boring compared to its discrete-time variant that we studied in <a href="ch2.html#sec-The-population-growth-of-rabbits" class="quarto-xref"><span>Section 2.2</span></a>. The difference is that the overshooting and undershooting do not occur in continuous time. By changing the logistic model in Grind to:<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dX <span class="ot">&lt;-</span> r <span class="sc">*</span> X <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>X) <span class="sc">-</span> X </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and using <code>method='euler'</code> in the <code>run()</code> function, you can simulate the discrete-time logistic map. Check if you get chaos for <span class="math inline">\(r = 4\)</span>. Use the Euler method only in special cases, as it is generally the least accurate approach.</p>
</section>
<section id="sec-The-LotkaVolterra-models" class="level3 page-columns page-full" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="sec-The-LotkaVolterra-models"><span class="header-section-number">4.2.2</span> The Lotka—Volterra models</h3>
<div class="page-columns page-full"><p>Perhaps the best-known population models are the Lotka—Volterra equations <span class="citation" data-cites="murrayMathematicalBiology2002">(<a href="references.html#ref-murrayMathematicalBiology2002" role="doc-biblioref">Murray 2002</a>)</span>.  These consist of coupled differential equations, one for the density of the prey and one for the density of the predator:</p><div class="no-row-height column-margin column-container"><span class="margin-aside">The Lotka—Volterra models describe the dynamics of biological systems in which two species interact, one as a predator and the other as prey.</span></div></div>
<p><span id="eq-ch4n-3-old-23"><span class="math display">\[
\begin{gathered}
\frac{dN}{dt} = aN - bPN, \\
\frac{dP}{dt} = cPN - dP,
\end{gathered}
\tag{4.3}\]</span></span></p>
<p>where <span class="math inline">\(N\)</span> and <span class="math inline">\(P\)</span> refer to the sizes of the prey and predator populations, <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> determine the growth rates, and <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> control the mortality rates. Note that the mortality rate of prey depends on both <span class="math inline">\(N\)</span> and <span class="math inline">\(P\)</span>, while the mortality rate of predators depends only on <span class="math inline">\(P\)</span>. Similarly, the growth terms are also asymmetric, predators increase as a function of both <span class="math inline">\(N\)</span> and <span class="math inline">\(P\)</span>, as they eat prey. We will follow the simple example provided by Wikipedia (on Lotka—Volterra equations).</p>
<p>To implement this model in Grind, we use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>LV <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    dN <span class="ot">&lt;-</span> a <span class="sc">*</span> N <span class="sc">-</span> b <span class="sc">*</span> P <span class="sc">*</span> N</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    dP <span class="ot">&lt;-</span> c <span class="sc">*</span> P <span class="sc">*</span> N <span class="sc">-</span> d <span class="sc">*</span> P</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dN, dP)))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="fl">1.1</span>, <span class="at">b =</span> .<span class="dv">4</span>, <span class="at">c =</span> .<span class="dv">1</span>, <span class="at">d =</span> <span class="fl">0.4</span>) <span class="co"># parameters</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">10</span>, <span class="at">P =</span> <span class="dv">10</span>) <span class="co"># 10 baboons and 10 cheetahs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Some typical uses of Grind are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">run</span>(<span class="at">odes =</span> LV, <span class="at">tstep =</span> .<span class="dv">01</span>, <span class="at">table =</span> <span class="cn">TRUE</span>) <span class="co"># set tstep to low value</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># phase plot for different starting values:</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">odes =</span> LV, <span class="at">portrait =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="dv">17</span>, <span class="at">xmax =</span> <span class="dv">50</span>, <span class="at">tstep =</span> <span class="fl">0.1</span>, <span class="at">grid =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The plane function makes a phase plot with <span class="math inline">\(N\)</span> and <span class="math inline">\(P\)</span> as axes. The black points are initial states. What we learn from this is that the equilibrium of the Lotka—Volterra equations is a limit cycle that depends on the choice of the initial conditions.</p>
<p>A well-known improvement to this model is to make the prey growth density dependent by using the logistic equation. This can be done by setting <code>dN &lt;- a*N *(1-N) - b*P*N</code> in the model. This is the case used as an example in the Grind tutorial, which I highly recommend reading <span class="citation" data-cites="deboerSimplePhasePlane2018">(<a href="references.html#ref-deboerSimplePhasePlane2018" role="doc-biblioref">de Boer 2018</a>)</span>. It also contains the appropriate parameter values for this model variant. In this density-dependent model, there are fixed points, in contrast to the original model. This shows that such model choices can have a large effect.</p>
<div class="page-columns page-full"><p>A famous example of a system of three coupled differential equations is the Susceptible-Infected-Recovered (SIR) model used to model infectious diseases and to understand the impact of interventions on disease dynamics.  The states of the model are susceptible, representing individuals who have not yet contracted the disease but are at risk; infected, representing individuals who are currently infected and can transmit the disease to susceptible individuals; and recovered, representing individuals who have recovered from the disease and are assumed to be immune and no longer susceptible. The differential equations specify the change in susceptible, infected, and recovered members of the population. You can now easily implement this model yourself (see exercises).</p><div class="no-row-height column-margin column-container"><span class="margin-aside">The Susceptible-Infected-Recovered (SIR) model is a basic epidemiological model that divides a population into susceptible (S), infected (I), and recovered (R) individuals.</span></div></div>
</section>
<section id="sec-Fitting-models-stochasticity-versus-noise" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="sec-Fitting-models-stochasticity-versus-noise"><span class="header-section-number">4.2.3</span> Fitting models: Stochasticity versus noise</h3>
<p>Grind includes an option to fit dynamical systems models. With <code>fit()</code>, based on the <code>modFit()</code> function from the FME package <span class="citation" data-cites="soetaert2010">(<a href="references.html#ref-soetaert2010" role="doc-biblioref">Soetaert, Petzoldt, and Setzer 2010</a>)</span>, one can estimate the model parameters given a dataset. These functions also provide confidence intervals and allow fixing parameters and bootstrap analysis. Fitting nonlinear dynamical systems models to data is an art in itself. For example, these methods can be very sensitive to the choice of initial values.</p>
<p>I will illustrate the use of <code>fit()</code> on three datasets created with the original Lotka—Volterra model from the previous section. The first dataset is the deterministic dataset, the data that follow directly from the code above. The second is created using a stochastic Lotka—Volterra model. I will explain how this works in the next section. The third is a deterministic dataset with measurement error. We will see that the last two cases are very different.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="fl">1.1</span>, <span class="at">b =</span> .<span class="dv">4</span>, <span class="at">c =</span> .<span class="dv">1</span>, <span class="at">d =</span> <span class="fl">0.4</span>)<span class="co"># p is a named vector of parameters</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">N =</span> <span class="dv">10</span>, <span class="at">P =</span> <span class="dv">10</span>) <span class="co"># s is the state</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>data_deterministic <span class="ot">&lt;-</span> <span class="fu">run</span>(<span class="at">odes =</span> LV, n, <span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">timeplot =</span> <span class="cn">FALSE</span>) <span class="co"># deterministic data</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>data_stochastic <span class="ot">&lt;-</span> <span class="fu">run</span>(<span class="at">odes =</span> LV, n, <span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">after=</span><span class="st">"state&lt;-state+rnorm(2,0,.1)"</span>, <span class="at">timeplot =</span> <span class="cn">FALSE</span>) <span class="co"># add stochasticity</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>data_error <span class="ot">&lt;-</span> <span class="fu">run</span>(<span class="at">odes =</span> LV, n, <span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">timeplot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>data_error[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> data_error[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]<span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> n, <span class="dv">0</span>, <span class="dv">2</span>), , <span class="dv">2</span>) <span class="co"># measurement error </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#fit &amp; plot</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> s <span class="sc">*</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)); s <span class="co"># start values</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">*</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)); p <span class="co"># start values</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>f_deter <span class="ot">&lt;-</span> <span class="fu">fit</span>(<span class="at">odes =</span> LV, data_deterministic, <span class="at">main =</span> <span class="st">'deterministic'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>f_stoch <span class="ot">&lt;-</span> <span class="fu">fit</span>(<span class="at">odes =</span> LV, data_stochastic ,<span class="at">main =</span> <span class="st">'stochastic'</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>f_error <span class="ot">&lt;-</span> <span class="fu">fit</span>(<span class="at">odes =</span> LV, data_error, <span class="at">main =</span> <span class="st">'error'</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(f_deter<span class="sc">$</span>par[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>], f_stoch<span class="sc">$</span>par[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>], f_error<span class="sc">$</span>par[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>]), ,<span class="dv">3</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pars, <span class="fu">c</span>(<span class="fu">summary</span>(f_deter)<span class="sc">$</span>sigma, <span class="fu">summary</span>(f_stoch)<span class="sc">$</span>sigma,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">summary</span>(f_error)<span class="sc">$</span>sigma))</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(pars), <span class="at">beside =</span> <span class="cn">TRUE</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>,<span class="st">'d'</span>, <span class="st">'Residuals'</span>),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">args.legend =</span> <span class="fu">c</span>(<span class="at">x =</span> <span class="dv">13</span>), <span class="at">legend.text =</span> <span class="fu">c</span>(<span class="st">'deterministic'</span>, <span class="st">'stochastic'</span>, <span class="st">'error'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This results in <a href="#fig-ch4n-img1-old-49" class="quarto-xref">figure&nbsp;<span>4.1</span></a>.</p>
<div id="fig-ch4n-img1-old-49" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img1-old-49-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img1-old-49.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img1-old-49-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Fit of the Lotka—Volterra model on three types of data. The lines represent the fitted curves. In the stochastic case, noise is part of the system that affects the computation of the state at the next time step. In the error case, noise is a measurement error that does not affect the dynamics.
</figcaption>
</figure>
</div>
<p>Note that the error dataset looks very similar to the deterministic dataset because it contains only the measurement error (<span class="math inline">\(X\)</span> is true score + error). The error does not affect the dynamics itself. In the stochastic case, the error (noise) is added to the states after each time step, which affects the dynamics. In <a href="#fig-ch4n-img1-old-49" class="quarto-xref">figure&nbsp;<span>4.1</span></a>, you can see that the positions of the waves change. In this well-chosen case, the fit is quite good in all three cases, and the parameter estimates are all quite close to the true values. Unfortunately, these results are quite unstable. You can do some testing yourself.</p>
</section>
<section id="sec-Back-to-the-cusp" class="level3 page-columns page-full" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="sec-Back-to-the-cusp"><span class="header-section-number">4.2.4</span> Back to the cusp</h3>
<p>To illustrate how Grind can be used to perform bifurcation analysis, we go back to the cusp. Recall that the differential equation for the cusp is</p>
<p><span id="eq-ch4n-5-old-25"><span class="math display">\[
\frac{dX}{dt} = - V^{'}(X) = {a + bX - X}^{3}.
\tag{4.4}\]</span></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)),{</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    dX <span class="ot">&lt;-</span>  a <span class="sc">+</span> b <span class="sc">*</span> X <span class="sc">-</span> X<span class="sc">^</span><span class="dv">3</span> <span class="co"># cusp</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(dX))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>); s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">X =</span> .<span class="dv">1</span>); <span class="fu">run</span>(<span class="at">ymin =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>s[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">1</span>; <span class="fu">run</span>(<span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code simulates two runs demonstrating bistability for <span class="math inline">\(a = 0\)</span> and <span class="math inline">\(b = 1\)</span>.</p>
<p>A nicer way to demonstrate bistability in the time series is to make the system stochastic. This was done in Chapter 3, <a href="ch3.html#sec-Cobbs-maximum-likelihood-approach" class="quarto-xref"><span>Section 3.5.2.1</span></a>, by using a stochastic differential equation: <span class="math inline">\(dX = - V^{'}(X)dt + \sigma dW(t)\)</span>. Grind has a great trick for this. With the “after” parameter in the function call, we can add discrete events to the system. “After” can also be used to change parameter or state values after a certain amount of time or after some condition (see the manual). We use it here to add a random number sampled from a normal distribution, with a mean of 0 and a standard deviation of .4, to <span class="math inline">\(X\)</span>. The best way to simulate this in Grind is using the Euler method with a small time step. The noise term should be corrected with <span class="math inline">\(\sqrt{dt}\)</span>, as shown in the code. The Wikipedia page on stochastic differential equations will tell you more about the underlying ideas.</p>
<div class="page-columns page-full"><p>As can be seen in <a href="#fig-ch4n-img2-old-50" class="quarto-xref">figure&nbsp;<span>4.2</span></a>, the stochastic force causes spontaneous jumps between the two modes of the cusp. When noise or random fluctuations cause the entire equilibrium landscape of a dynamical system to become observable, it is often referred to as stochastic resonance.  You can see this by comparing the figure with one generated with a standard deviation of .1 or less.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">Stochastic resonance is a notable example of how noise, which is often considered undesirable or disruptive, can actually play a constructive role in certain systems, helping to reveal hidden patterns and structures that might otherwise remain obscured.</span></div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">t</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">run</span>(<span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">tmax =</span> <span class="dv">1000</span>, <span class="at">method =</span> <span class="st">'euler'</span>, <span class="at">tstep =</span> .<span class="dv">1</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">after =</span> <span class="st">"state &lt;- state + rnorm(1,mean=0,sd=0.4) * sqrt(tstep)"</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymax =</span> <span class="dv">2</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">timeplot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data, <span class="at">type =</span> <span class="st">'l'</span>, <span class="at">bty =</span> <span class="st">'n'</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">hist</span>(data[,<span class="dv">2</span>], <span class="dv">30</span>, <span class="at">plot =</span> F)<span class="sc">$</span>counts, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">hor =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-ch4n-img2-old-50" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img2-old-50-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img2-old-50.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img2-old-50-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Spontaneous jumps in the cusp due to stochastics (noise). Due to stochastic perturbations, the system occasionally jumps over the maxima that separate the minima. Interestingly, when the noise is reduced, the time series tends to become trapped in a single equilibrium. Thus, increased noise helps reveal the overall equilibrium landscape. This phenomenon is known as stochastic resonance.
</figcaption>
</figure>
</div>
</section>
<section id="sec-Bifurcation-analysis" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="sec-Bifurcation-analysis"><span class="header-section-number">4.2.5</span> Bifurcation analysis</h3>
<p>By combining the Grind functions <code>newton()</code> and <code>continue()</code>, we can perform bifurcation analysis. The <code>newton()</code> function finds stable and unstable fixed points, and the <code>continue()</code> function implements the parameter continuation of a steady state, providing a bifurcation diagram. It shows the change in equilibria when we change a parameter. This is what we did in Chapter 2 for the logistic map, when we varied <span class="math inline">\(r\)</span> and plotted the equilibria (see <a href="ch2.html#fig-ch2-img8" class="quarto-xref">figure&nbsp;<span>2.8</span></a>).</p>
<p>It is often necessary to run the combination of these two functions repeatedly, starting from different initial states. The code to create <a href="#fig-ch4n-img3-old-51" class="quarto-xref">figure&nbsp;<span>4.3</span></a> is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>low <span class="ot">&lt;-</span> <span class="fu">newton</span>(<span class="at">s =</span> <span class="fu">c</span>(<span class="at">X =</span> <span class="sc">-</span><span class="dv">1</span>)) <span class="co"># finds a minimum starting from X = -1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Continue this steady state varying a</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">continue</span>(low, <span class="at">x =</span> <span class="st">"a"</span>, <span class="at">y =</span> <span class="st">"X"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">ymax =</span> <span class="dv">2</span>) </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>high <span class="ot">&lt;-</span> <span class="fu">newton</span>(<span class="at">s =</span> <span class="fu">c</span>(<span class="at">X =</span> <span class="dv">1</span>)) <span class="co"># again starting from X = 1</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">continue</span>(high, <span class="at">x =</span> <span class="st">"a"</span>, <span class="at">y =</span> <span class="st">"X"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">ymax =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-ch4n-img3-old-51" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img3-old-51-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/ch4-3-june14.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img3-old-51-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: Hysteresis plot made with <code>newton()</code> and <code>continue()</code>. The function <code>newton()</code> finds an equilibrium, which is used in <code>continue()</code> to vary the normal variable a until a bifurcation point is found.
</figcaption>
</figure>
</div>
<p>Another great tool in R is the deBif package by de Roos.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> This is an R Shiny application that uses the same model specification and allows for a more interactive investigation. Given our previous model and the definition of <span class="math inline">\(s\)</span> and <span class="math inline">\(p\)</span>, we can run:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"deBif"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deBif)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">phaseplane</span>(model, s, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>phaseplane()</code> function returns a time plot and the steady states. You can change parameters and initial states on the left side, and plot parameters on the upper right side (click on the two gears). The Steady States option is very useful as it shows the stable and unstable fixed points. Make sure that the minima and maxima of the plot axes are set correctly.</p>
<p>With</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bifurcation</span>(model, s, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can create one- and two-parameter bifurcation diagrams (using the LP curve option, see <a href="#fig-ch4n-img4-old-52" class="quarto-xref">figure&nbsp;<span>4.4</span></a>). The two-parameter bifurcation diagram (bottom left) cannot be created in Grind. See the deBif help pages (with <code>??deBif</code>) for further instructions.</p>
<div id="fig-ch4n-img4-old-52" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img4-old-52-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/ch4n-4-june24.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img4-old-52-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: Output from Shiny app deBif. The last plot is a two-dimensional bifurcation diagram showing the bifurcation lines of the cusp in the <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> plane. This plot cannot be made with Grind.
</figcaption>
</figure>
</div>
</section>
<section id="sec-Spruce-Budworm-outbreak-model" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="sec-Spruce-Budworm-outbreak-model"><span class="header-section-number">4.2.6</span> Spruce budworm outbreak model</h3>
<p>In Chapter 3, <a href="ch3.html#sec-Mechanistic-models" class="quarto-xref"><span>Section 3.4.1</span></a>, I introduced the spruce budworm outbreak model. We will use this model later as a model of addiction. The bifurcation diagram can be made with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>spruce <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    du <span class="ot">=</span> r <span class="sc">*</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> u<span class="sc">/</span>q) <span class="sc">-</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(du)))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>state <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">u =</span> <span class="fl">0.5</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r =</span> <span class="fl">0.4</span>, <span class="at">q =</span> <span class="dv">10</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">bifurcation</span>(spruce, state, parms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that this predator-prey model consists of only one equation. There is no separate dynamic equation for the birds. The reason is that these budworm outbreaks happen in a few weeks. Birds do not reproduce on this time scale. The variables are reparametrized (see <a href="ch3.html#sec-Mechanistic-models" class="quarto-xref"><span>Section 3.4.1</span></a>). The predation term, in the original parametrization <span class="math inline">\(- BN^{2}/(A^{2} + N^{2})\)</span>, also has a logistic form that starts to accelerate at <span class="math inline">\(N = A\)</span> up to the maximum level <span class="math inline">\(B\)</span>. The slow start <span class="math inline">\(A\)</span> is used because birds only switch their diet to budworms when this population reaches a certain level <span class="citation" data-cites="ludwig1978">(<a href="references.html#ref-ludwig1978" role="doc-biblioref">Ludwig, Jones, and Holling 1978</a>)</span>. The fixed number of birds can only eat <span class="math inline">\(B\)</span> budworms. This specific predation term is called the Holling type III model. All Holling types and their formulas are shown in <a href="#fig-ch4n-img5-old-53" class="quarto-xref">figure&nbsp;<span>4.5</span></a>.</p>
<div id="fig-ch4n-img5-old-53" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img5-old-53-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/ch4-5-may31.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img5-old-53-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: The Holling functional response models. Type III is used in the spruce budworm model.
</figcaption>
</figure>
</div>
</section>
<section id="sec-Evaluation-of-ecological-modelling" class="level3 page-columns page-full" data-number="4.2.7">
<h3 data-number="4.2.7" class="anchored" data-anchor-id="sec-Evaluation-of-ecological-modelling"><span class="header-section-number">4.2.7</span> Evaluation of ecological modeling</h3>
<div class="page-columns page-full"><p>Understanding the technical basics of dynamical systems theory is one thing, but actually building useful dynamical system models is quite another. Every term in each differential equation of a model needs some underpinning. These models make many assumptions, both implicit and explicit. The Lotka—Volterra model, for example, assumes that the prey population grows exponentially in the absence of the predator, that the predator population dies off with the prey population and does not switch to other prey species, that the response of the predator population to changes in the prey population is direct and not delayed, that there is no spatial component to the model, and that the rates of change of the populations are proportional to their sizes, to name just a few. These assumptions are widely debated in the biological literature <span class="citation" data-cites="abramsNaturePredationPrey2000">(<a href="references.html#ref-abramsNaturePredationPrey2000" role="doc-biblioref">Abrams et al. 2000</a>)</span>, and modifying these assumptions may have significant consequences. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Hundreds of extensions and variants of the Lotka—Volterra model have been proposed and studied.</span></div></div>
<p>For example, the original Lotka—Volterra model has no stable points, only limit cycles. While these cycles have been observed in nature, they are not overwhelmingly common. As we have seen, the dynamics of the system are significantly altered when prey growth is made dependent on prey density. This model has fixed-point equilibria instead of limit cycles.</p>
<p>Adding a spatial component can also make a big difference, as shown in the example of hypercycles in see <a href="ch5n.html#sec-Biology" class="quarto-xref"><span>Section 5.2.3</span></a> (see <span class="citation" data-cites="szostakHypercycle2016">Szostak, Wasik, and Blazewicz (<a href="references.html#ref-szostakHypercycle2016" role="doc-biblioref">2016</a>)</span> for a brief review). Adding more prey and predator species also makes a difference <span class="citation" data-cites="johnsonModelingMultispeciesPredator2019">(<a href="references.html#ref-johnsonModelingMultispeciesPredator2019" role="doc-biblioref">Johnson, Mumma, and St-Laurent 2019</a>)</span>. There are many interesting options for the predator term in the prey equation. <span class="citation" data-cites="tyutyunov2020">Tyutyunov and Titova (<a href="references.html#ref-tyutyunov2020" role="doc-biblioref">2020</a>)</span> compare 12 trophic functions, alternatives to the Holling functional responses. The options are overwhelming. Biologists face a problem here that I discussed in Chapter 1, <a href="ch1.html#sec-The-art-of-simplification" class="quarto-xref"><span>Section 1.4</span></a>. Models easily become too complex. Recall that the traffic simulation models were extremely simple, yet sufficient to explain key phenomena.</p>
<div class="page-columns page-full"><p>An additional problem is that empirically testing all these different models is difficult. Although the quality of biological data is often superior to that of psychological data, biologists must also rely on the qualitative predictions of their models. Models in chemistry and especially physics can often be tested quantitatively. Transitions occur precisely at the predicted values of the control variables. Ecological models, much like those in psychology, do not allow for this level of prediction. This is a problem because if we can only test our model qualitatively (Are there limit cycles? What type of transitions can be detected? Is there hysteresis?), many model choices are not particularly relevant. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">One of the most significant challenges in complex-systems research in the life sciences and psychology is constructing dynamical system models that effectively address these data-related issues.</span></div></div>
<p>A case in which this is less of an issue is the traffic example that I introduced in Chapter 1. I asked you to play around with the online simulation. We now know the basics to better understand this model. The Wikipedia page on this model (Intelligent Driver Model) presents the equations, which are also coupled ordinary differential equations. The implementation in Grind of the simplest case looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms){</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)),{</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> state[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> state[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>n)]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    dx <span class="ot">&lt;-</span>  v <span class="co"># change in distance = speed</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    delta_v <span class="ot">&lt;-</span> v <span class="sc">-</span> m <span class="sc">%*%</span> v <span class="co"># difference in speed to next car</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    s_alpha <span class="ot">&lt;-</span> m <span class="sc">%*%</span> x <span class="sc">-</span> x <span class="sc">-</span> l <span class="co">#  distance to next car</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    s_alpha[n] <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># front car has no car in front</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    s_star <span class="ot">&lt;-</span> s0 <span class="sc">+</span> v <span class="sc">*</span> T <span class="sc">+</span> v <span class="sc">*</span> delta_v <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(a <span class="sc">*</span> b))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    dv <span class="ot">&lt;-</span> a <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> (v<span class="sc">/</span>v0)<span class="sc">^</span>delta <span class="sc">-</span> (s_star<span class="sc">/</span>s_alpha)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># change in speed</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dx, dv)))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">l =</span> <span class="dv">5</span>, <span class="at">v0 =</span> <span class="dv">30</span>, <span class="at">T =</span> <span class="fl">1.5</span>, <span class="at">a =</span> .<span class="dv">73</span>, <span class="at">b=</span> <span class="fl">1.67</span> , <span class="at">delta =</span> <span class="dv">4</span>, <span class="at">s0 =</span> <span class="dv">2</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>x_init <span class="ot">&lt;-</span> (<span class="dv">0</span><span class="sc">:</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> (p[<span class="st">'s0'</span>] <span class="sc">+</span> p[<span class="st">'l'</span>])</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>v_init <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(x_init, v_init)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, n, n); m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(m[<span class="sc">-</span><span class="dv">1</span>,], <span class="dv">0</span>) <span class="co"># order cars</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation with front car suddenly breaking at t = 150:</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">run</span>(<span class="at">tmax =</span> <span class="dv">300</span>, <span class="at">timeplot =</span> <span class="cn">FALSE</span>, <span class="at">table =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">after =</span> <span class="st">'if (t==150) state[2*n] = 0'</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(data[,<span class="dv">2</span><span class="sc">:</span>(n <span class="sc">+</span> <span class="dv">1</span>)], <span class="at">type =</span> <span class="st">'l'</span>, <span class="at">bty =</span> <span class="st">'n'</span>, <span class="at">xlab =</span> <span class="st">'time'</span>, <span class="at">ylab =</span> <span class="st">'x'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-ch4n-img6-old-54" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img6-old-54-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img6-old-54.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img6-old-54-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: The traffic jam simulation. The top line represents the front car, which moves off immediately. Other cars are waiting for their turn. At <span class="math inline">\(t = 150\)</span>, the first car suddenly breaks off, creating a traffic jam for the later cars. The effect of this disturbance is greater for the last car than for the first car. This simulated graph resembles the real data very well <span class="citation" data-cites="jusup2022">(see for example figure 9 in <a href="references.html#ref-jusup2022" role="doc-biblioref">Jusup et al. 2022</a>)</span>.
</figcaption>
</figure>
</div>
<div class="page-columns page-full"><p>The result of this simulation is shown in <a href="#fig-ch4n-img6-old-54" class="quarto-xref">figure&nbsp;<span>4.6</span></a>. Understanding the reasoning behind the differential equation is not so easy, but I want to make another point. The Wikipedia page gives parameters values with units (s, m/s, or m/s<sup>2</sup>). One can also have dimension-free parameters (the acceleration exponent).  This dimensional analysis is a crucial step in modeling in physics but a weak point in biological and especially psychological applications. This hampers the quantitative test of models.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">Dimensional analysis involves analyzing the dimensions of quantities to derive relationships and scaling laws, ensuring that the equations are consistent.</span></div></div>
</section>
</section>
<section id="sec-Psychological-models" class="level2 page-columns page-full" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-Psychological-models"><span class="header-section-number">4.3</span> Psychological models</h2>
<p>In this section, I present an overview of dynamical systems models in psychology, primarily in the form of systems of differential equations. Although the list is extensive, it is not exhaustive. It is important to explore different models and applications before embarking on your own modeling efforts.</p>
<section id="sec-Response-time-models" class="level3 page-columns page-full" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="sec-Response-time-models"><span class="header-section-number">4.3.1</span> Response time models</h3>
<div class="page-columns page-full"><p>Many dynamic models have been proposed in the study of speeded decision-making <span class="citation" data-cites="bogaczPhysicsOptimalDecision2006">(<a href="references.html#ref-bogaczPhysicsOptimalDecision2006" role="doc-biblioref">Bogacz et al. 2006</a>)</span>. The best-studied case is the two-alternative forced-choice task, where a stimulus is presented, and a choice must be made between two alternatives as quickly as possible. The stimulus could be an arrow pointing left or right. Most popular are accumulator models (<a href="#fig-ch4n-img7-old-55" class="quarto-xref">figure&nbsp;<span>4.7</span></a>). </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Accumulator models assume that noisy information is accumulated over time until a decision bound is reached and a motor response is initiated.</span></div></div>
<div id="fig-ch4n-img7-old-55" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img7-old-55-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img7-old-55.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img7-old-55-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.7: A stochastic accumulator model of speeded decision-making. Evidence accumulates in stochastic steps biased by the drift rate <span class="math inline">\(I\)</span> (stimulus related). When one of the bounds is reached, a response is generated that may be incorrect if the bounds are too low.
</figcaption>
</figure>
</div>
<p>One way to model this process is with a single stochastic linear differential equation, called the drift-diffusion model (DDM), with <span class="math inline">\(I\)</span> as the stimulus-driven input:</p>
<p><span id="eq-ch4n-6-old-26"><span class="math display">\[
dX = Idt + \sigma dW.
\tag{4.5}\]</span></span></p>
<p>As before, <span class="math inline">\(dt\)</span> is moved to the left-hand side of the equation. <span class="math inline">\(dW\)</span> is white noise, normally distributed with 0 mean and with standard deviation <span class="math inline">\(\sigma\)</span> (set to .1 by default). We start at 0, <span class="math inline">\(X_{t = 0} = 0\)</span>, assuming no bias for one of the choice alternatives.</p>
<p>The implementation of the model in Grind is quite simple. The trick is again in the run statement, which adds white noise after each step.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> We stop the run when either the negative or positive bound is reached.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    dX <span class="ot">=</span> I</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dX)))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">I =</span> .<span class="dv">01</span>); s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">X =</span> <span class="dv">0</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>bound <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">table =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">'euler'</span>, <span class="at">tstep =</span> .<span class="dv">1</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">tmax =</span> <span class="dv">500</span>, <span class="at">after =</span> <span class="st">"state&lt;-state+rnorm(1,mean=0,sd=0.1)*sqrt(tstep);</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="st">    if(abs(state)&gt;bound) break"</span>, <span class="co"># stop at bound</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="sc">-</span>bound, <span class="at">ymax =</span> bound)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="page-columns page-full"><p>The model explains observed response time and accuracy in terms of the underlying process parameters, drift rate, and confidence bound. By fitting the model to the data, we can determine whether slow responses are due to a low drift rate (low skill or difficult task) or a conservatively chosen bound. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Accumulator models such as the drift-diffusion model explain the speed-accuracy trade-off. If we set our confidence bound higher, we are slower but more accurate.</span></div></div>
<p>A well-known extension of the drift-diffusion model is the Ornstein—Uhlenbeck model:</p>
<p><span id="eq-ch4n-7-old-27"><span class="math display">\[
dX = (\lambda x + I)dt + \sigma dW.
\tag{4.6}\]</span></span></p>
<p>For <span class="math inline">\(\lambda &lt; 0\)</span> this process converges to <span class="math inline">\(I/\lambda\)</span> (assuming <span class="math inline">\(\sigma = 0\)</span>), while for <span class="math inline">\(\lambda &gt; 0\)</span> it diverges. For the psychological interpretation, I refer to <span class="citation" data-cites="bogaczPhysicsOptimalDecision2006">Bogacz et al. (<a href="references.html#ref-bogaczPhysicsOptimalDecision2006" role="doc-biblioref">2006</a>)</span>. The simplest two-dimensional model is the race model:</p>
<p><span id="eq-ch4n-8-old-28"><span class="math display">\[
\begin{gathered}
dX_{1} = I_{1}dt + \sigma W_{1}, \\
dX_{2} = I_{2}dt + \sigma W_{2}.
\end{gathered}
\tag{4.7}\]</span></span></p>
<p>Now two independent processes run (race) to one positive bound. The first one to arrive wins. More biologically inspired models involve inhibition. The equations of mutual inhibition model are:</p>
<p><span id="eq-ch4n-9-old-29"><span class="math display">\[
\begin{gathered}
dX_{1} = (-k_{1}X_{1} - w_{1}X_{2} + I_{1})dt + \sigma W_{1}, \\
dX_{2} = (-k_{2}X_{2} - w_{2}X_{1} + I_{2})dt + \sigma W_{2}.
\end{gathered}
\tag{4.8}\]</span></span></p>
<p>Note that these are all linear dynamical systems that do not exhibit complex behavior. Examples of nonlinear alternatives are presented in <span class="citation" data-cites="roxinNeurobiologicalModelsTwoChoice2008">Roxin and Ledberg (<a href="references.html#ref-roxinNeurobiologicalModelsTwoChoice2008" role="doc-biblioref">2008</a>)</span> and <span class="citation" data-cites="verdonckIsingDecisionMaker2014">Verdonck and Tuerlinckx (<a href="references.html#ref-verdonckIsingDecisionMaker2014" role="doc-biblioref">2014</a>)</span> and discussed in <span class="citation" data-cites="ratcliffDiffusionDecisionModel2016">Ratcliff et al. (<a href="references.html#ref-ratcliffDiffusionDecisionModel2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>The relations between different accumulator models are summarized in <a href="#fig-ch4n-img8-old-56" class="quarto-xref">figure&nbsp;<span>4.8</span></a>. It shows that convenient models such as the drift-diffusion mode can be derived by constraints on the parameters from more biologically realistic models, such as the pooled and mutual inhibition model.</p>
<div id="fig-ch4n-img8-old-56" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img8-old-56-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/ch4n-8__figure57.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img8-old-56-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.8: Relations between the main evidence accumulator models of decision-making. DDM is the drift-diffusion model which can be derived from the mutual inhibition model by setting <span class="math inline">\(w = k\)</span> and <span class="math inline">\(w + k\)</span> to a large value. <span class="citation" data-cites="bogaczPhysicsOptimalDecision2006">(Adapted from <a href="references.html#ref-bogaczPhysicsOptimalDecision2006" role="doc-biblioref">Bogacz et al. 2006</a>)</span>
</figcaption>
</figure>
</div>
</section>
<section id="sec-Dyadic-models" class="level3 page-columns page-full" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="sec-Dyadic-models"><span class="header-section-number">4.3.2</span> Dyadic models</h3>
<p>The study of dyadic interaction lends itself to dynamic modeling. Dyadic interactions have been studied extensively in the field of caregiver-child interactions <span class="citation" data-cites="ainsworthPatternsAttachmentPsychological2015">(<a href="references.html#ref-ainsworthPatternsAttachmentPsychological2015" role="doc-biblioref">Ainsworth et al. 2015</a>)</span>. Here, we focus on a dyadic interaction in romantic relationships.</p>
<section id="sec-Romeo-and-Juliet" class="level4 page-columns page-full" data-number="4.3.2.1">
<h4 data-number="4.3.2.1" class="anchored" data-anchor-id="sec-Romeo-and-Juliet"><span class="header-section-number">4.3.2.1</span> Romeo and Juliet</h4>
<p>One type of model can be traced back to publications by <span class="citation" data-cites="rapoportFightsGamesDebates1960">Rapoport (<a href="references.html#ref-rapoportFightsGamesDebates1960" role="doc-biblioref">1960</a>)</span> and <span class="citation" data-cites="strogatzLoveAffairsDifferential1988">Strogatz (<a href="references.html#ref-strogatzLoveAffairsDifferential1988" role="doc-biblioref">1988</a>)</span>. I follow the setup described by <span class="citation" data-cites="sprottDynamicalModelsLove2004">Sprott (<a href="references.html#ref-sprottDynamicalModelsLove2004" role="doc-biblioref">2004</a>)</span>. Note that it was intended as a toy model to demonstrate dynamical modeling.</p>
<p>The model is about the interactions between Romeo and Juliet, where <span class="math inline">\(R\)</span> and <span class="math inline">\(J\)</span> represent the feelings of Romeo and Juliet. The change in feelings is supposed to be a function of the feelings of both people:</p>
<p><span id="eq-ch4n-10-old-30"><span class="math display">\[\begin{gathered}
\frac{dR}{dt} = aR + bJ, \\
\frac{dJ}{dt} = cR + dJ.
\end{gathered}
\tag{4.9}\]</span></span></p>
<div class="page-columns page-full"><p>First note that the case of <span class="math inline">\(b = c = 0\)</span> resembles the exponential model with solutions <span class="math inline">\(R = {R_{0}e}^{at}\)</span> and <span class="math inline">\(J = {J_{0}e}^{dt}\)</span>, which converge (to 0) or diverge (to infinity) depending on whether <span class="math inline">\(a\)</span> and <span class="math inline">\(d\)</span> are negative or positive.  We will see a more sensible setup in the next model. Nevertheless, this system of coupled linear differential equations is surprisingly rich in behavior. With the signs of the parameters we define very different romantic styles. <span class="citation" data-cites="strogatzLoveAffairsDifferential1988">Strogatz (<a href="references.html#ref-strogatzLoveAffairsDifferential1988" role="doc-biblioref">1988</a>)</span> distinguishes the following:</p><div class="no-row-height column-margin column-container"><span class="margin-aside">Divergence in this model, unbounded exponential growth of positive feelings, is an attractive concept but unrealistic, I’m afraid.</span></div></div>
<ul>
<li><p>Eager beaver: <span class="math inline">\(a\  &gt; \ 0,\ b\  &gt; \ 0\)</span>, Romeo is encouraged by his own feelings as well as Juliet’s.</p></li>
<li><p>Narcissistic nerd: <span class="math inline">\(a\  &gt; \ 0,\ b\  &lt; \ 0,\)</span> Romeo wants more of what he feels but retreats from Juliet’s feelings.</p></li>
<li><p>Cautious (secure) lover: <span class="math inline">\(a\  &lt; \ 0,\ b\  &gt; \ 0\)</span>, Romeo retreats from his own feelings but is encouraged by Juliet’s.</p></li>
<li><p>Hermit: <span class="math inline">\(a\  &lt; \ 0,\ b\  &lt; \ 0,\)</span> Romeo retreats from his own feelings as well as Juliet’s.</p></li>
</ul>
<div class="page-columns page-full"><p>Juliet may have her own style, which leads to complicated interactions. <span class="citation" data-cites="sprottDynamicalModelsLove2004">Sprott (<a href="references.html#ref-sprottDynamicalModelsLove2004" role="doc-biblioref">2004</a>)</span> and other sources give an extended analytical treatment of this model.  If you want to learn more about dynamical systems, you should study matrix algebra and its applications in linear dynamical systems. I have chosen to leave it out of this book because most psychological dynamical systems models are nonlinear. Here we just use Grind to test some cases. I give three examples with three different sets of parameter values. In the first case, the initial mutual interest fades; in the second case, the relationship fizzles out after some ups and downs; and in the third case, the couple ends up in a cycle of hate and love.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">Systems of linear differential equations can be solved analytically, and the behavior of the equilibria can be characterized by the eigenvalues. Some knowledge of matrix algebra is required to understand this.</span></div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    dR <span class="ot">&lt;-</span> a <span class="sc">*</span> R <span class="sc">+</span> b <span class="sc">*</span> J</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    dJ <span class="ot">&lt;-</span> c <span class="sc">*</span> R <span class="sc">+</span> d <span class="sc">*</span> J</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dR, dJ)))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> .<span class="dv">5</span>, <span class="at">d =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="co"># parameters</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">R =</span> <span class="fl">0.1</span>, <span class="at">J =</span> .<span class="dv">1</span>) </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>()</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">portrait =</span> <span class="cn">TRUE</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">grid =</span> <span class="dv">3</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">vector =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="sc">-</span>.<span class="dv">2</span>, <span class="at">b =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">c =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="dv">0</span>) <span class="co"># parameters</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">ymin =</span> <span class="sc">-</span>.<span class="dv">2</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">portrait =</span> <span class="cn">TRUE</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">grid =</span> <span class="dv">2</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">tstep =</span> .<span class="dv">001</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">b =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">c =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="fl">0.1</span>) <span class="co"># parameters</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">ymin =</span> <span class="sc">-</span>.<span class="dv">2</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">portrait =</span> <span class="cn">TRUE</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">grid =</span> <span class="dv">3</span>,</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">tstep =</span> .<span class="dv">001</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-ch4n-img9-old-57" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img9-old-57-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img9-old-57.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img9-old-57-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.9: Three different love affairs between Romeo and Juliet.
</figcaption>
</figure>
</div>
<div class="page-columns page-full"><p>The lines in the phase plots in <a href="#fig-ch4n-img9-old-57" class="quarto-xref">figure&nbsp;<span>4.9</span></a> are the nullclines.  In linear dynamical system, nullclines are straight lines. Where they intersect, stable or unstable fixed points can occur. Depending on the angle between the nullclines, we get a fixed point (first two cases), a limit cycle (last case), or divergence (not shown).</p><div class="no-row-height column-margin column-container"><span class="margin-aside">Nullclines are the curves for which the time derivatives of the behavioral variables <span class="math inline">\(R\)</span> and <span class="math inline">\(J\)</span> are 0.</span></div></div>
<p><span class="citation" data-cites="rinaldiLoveDynamicsCase1998">Rinaldi (<a href="references.html#ref-rinaldiLoveDynamicsCase1998" role="doc-biblioref">1998</a>)</span> proposed an extension and a constraint to the model that makes it a bit more realistic and easier to study. The basic equation is now <span class="math inline">\(dR/dt = - aR + bJ + A_{J}\)</span>, where <span class="math inline">\(a\)</span> is interpreted as a forgetting parameter (constrained to be positive) and <span class="math inline">\(A_{J}\)</span> is the attractiveness of the Juliet. In this case, a necessary and sufficient condition for asymptotic stability (i.e., having a fixed point) is that <span class="math inline">\(ad &gt; bc\)</span>.</p>
<p>Rinaldi also considers the case of a population of heterosexual men and women with different levels of attractiveness. The idea is that a man and a woman will leave their current partners and bond together when both reach a more optimal level of love. Rinaldi analyzes the conditions under which the population reaches a stable state. This marriage assignment problem, as it is called, is an example of a famous problem in optimization theory known as an assignment problem. The goal is to find a stable assignment of men to women, such that no man and woman prefer each other to their current partners <span class="citation" data-cites="galeCollegeAdmissionsStability1962">(<a href="references.html#ref-galeCollegeAdmissionsStability1962" role="doc-biblioref">Gale and Shapley 1962</a>)</span>. We use such algorithms to assign students to master tracks in our educational program.</p>
<p>Some other advanced variations of this model have been proposed. In these papers the analysis of the mathematical properties of the model gets much more attention than the psychological theory. It is often unclear what, exactly, the variables are and what the reasoning behind certain model assumptions. The work of Murray and Gottman, discussed in the next section, is more interesting in this regard.</p>
</section>
<section id="sec-The-mathematics-of-marriage" class="level4" data-number="4.3.2.2">
<h4 data-number="4.3.2.2" class="anchored" data-anchor-id="sec-The-mathematics-of-marriage"><span class="header-section-number">4.3.2.2</span> The mathematics of marriage</h4>
<p>The model of marriage developed by the psychologist John Gottman and the mathematical biologist James Murray <span class="citation" data-cites="gottmanMathematicsMarriageDynamic2002">(<a href="references.html#ref-gottmanMathematicsMarriageDynamic2002" role="doc-biblioref">2002</a>)</span> is firmly grounded in psychological theory and data. The main phenomenon that inspired this modeling work is Gottman and Levenson’s <span class="citation" data-cites="gottmanMaritalProcessesPredictive1992">(<a href="references.html#ref-gottmanMaritalProcessesPredictive1992" role="doc-biblioref">1992</a>)</span> finding that the patterns of interaction between couples, when discussing a major area of ongoing disagreement in their marriage, are predictive of divorce.</p>
<p>The model consists of two coupled difference equations, but I present it in the form of differential equations.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<p><span id="eq-ch4n-11-old-31"><span class="math display">\[
\begin{gathered}
\frac{dW}{dt} = I_{w}(H,a,b) - r_{w}W + W_{e}, \\
\frac{dH}{dt} = I_{h}(W,a,b) - r_{h}H + H_{e},
\end{gathered}
\tag{4.10}\]</span></span></p>
<p>where the influence functions <span class="math inline">\(I_{w}\)</span> and <span class="math inline">\(I_{h}\)</span> are defined as:</p>
<p><span id="eq-ch4n-12-old-32"><span class="math display">\[
I(x,a,b) = \frac{sgn(x)}{1 + e^{a\left( |x| - b \right)}}.
\tag{4.11}\]</span></span></p>
<p>I made up this flexible function to allow for very different forms of influence (as we will see below). When both influences are 0 (<span class="math inline">\(a = - 8,b = - \infty\)</span>), the state or mood of the wife (<span class="math inline">\(W\)</span>) and the husband (<span class="math inline">\(H\)</span>) converge to <span class="math inline">\(W_{e}\)</span> and <span class="math inline">\(H_{e}\)</span>, with rates <span class="math inline">\(r_{w}\)</span> and <span class="math inline">\(r_{h}\)</span>, respectively. <span class="math inline">\(W_{e}\)</span> and <span class="math inline">\(H_{e}\)</span> are the uninfluenced steady states of mood when the spouses do not interact.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p>However, if the influence function (<span class="math inline">\(a = - 8, b = 0\)</span>) is such that a positive mood in one spouse provokes a positive mood in the other, while a negative mood provokes a negative mood, we expect a negative and a positive equilibrium depending on the initial states and uninfluenced steady state values.</p>
<p>Another more complex influence function (<span class="math inline">\(a = - 8, b = 1\)</span>) assumes that only extreme mood states influence the other spouse.</p>
<p>This is implemented with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    dW <span class="ot">&lt;-</span> <span class="fu">influence</span>(H,a,b) <span class="sc">-</span> rw <span class="sc">*</span> W <span class="sc">+</span> We</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    dH <span class="ot">&lt;-</span> <span class="fu">influence</span>(W,a,b) <span class="sc">-</span> rh <span class="sc">*</span> H <span class="sc">+</span> He</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dW, dH)))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>influence <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">a =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sign</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(a <span class="sc">*</span> (<span class="fu">abs</span>(x) <span class="sc">-</span> b)))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">rw =</span> .<span class="dv">6</span>, <span class="at">rh =</span> .<span class="dv">6</span>, <span class="at">We =</span> .<span class="dv">18</span>, <span class="at">He =</span> <span class="sc">-</span>.<span class="dv">18</span>, <span class="at">a =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">b =</span> <span class="cn">Inf</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">W =</span> <span class="dv">0</span>, <span class="at">H =</span> <span class="dv">0</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="fu">c</span>(<span class="cn">Inf</span>, <span class="dv">0</span>, <span class="dv">1</span>)){</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  p[<span class="st">'b'</span>] <span class="ot">&lt;-</span> b</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">influence</span>(x, <span class="sc">-</span><span class="dv">8</span>, b), <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">xlab =</span> <span class="st">'W'</span>, <span class="at">ylab =</span> <span class="st">'H'</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plane</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">xmax =</span> <span class="fl">2.5</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">ymax =</span> <span class="dv">2</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by =</span> .<span class="dv">25</span>)) <span class="fu">newton</span>(<span class="at">s =</span> <span class="fu">c</span>(<span class="at">W =</span> i, <span class="at">H =</span> i), <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">run</span>(<span class="at">state =</span> <span class="fu">c</span>(<span class="at">W =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,.<span class="dv">5</span>), <span class="at">H =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="at">tmax =</span> <span class="dv">50</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymax =</span> <span class="dv">2</span>, <span class="at">add =</span> (i<span class="sc">&gt;</span><span class="dv">1</span>), <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This results in <a href="#fig-ch4n-img10-old-58" class="quarto-xref">figure&nbsp;<span>4.10</span></a>.</p>
<div id="fig-ch4n-img10-old-58" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img10-old-58-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img10-old-58.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img10-old-58-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.10: Qualitative difference marriage equilibrium landscapes depending on the form of the influence function. In the first (top), they simply have no influence and both partners converge to their uninfluenced steady states of mood. In the second (middle) , the response to the partner’s mood is extreme, resulting in either a positive or negative mutual state. In the last case (bottom), the response to low positive or negative moods is close to 0 but extreme at higher levels. Now there are three stable states.
</figcaption>
</figure>
</div>
<p>The three influence functions are shown in the first column, the nullclines in the second, and a series of runs from random initial states in the third. The first case shows that the moods converge to <span class="math inline">\(W_{e}\)</span> and <span class="math inline">\(H_{e}\)</span>, when there is no mutual influence. The second has two equilibria, with an unstable fixed point in the middle, while the last case has five fixed points, three of which are stable.</p>
<p>I have kept the influence functions and most parameters the same for both spouses, but this is not necessarily the case. It is possible to derive the equilibria analytically and to determine the stability of these equilibria <span class="citation" data-cites="gottmanMathematicsMarriageDynamic2002">(<a href="references.html#ref-gottmanMathematicsMarriageDynamic2002" role="doc-biblioref">Gottman et al. 2002</a>)</span>. They also propose a two-stage procedure for fitting the model to data consisting of positive and negative speaker interactions using a bilinear influence function. A more advanced statistical approach is proposed in <span class="citation" data-cites="hamaker2009">Hamaker, Zhang, and van&nbsp;der Maas (<a href="references.html#ref-hamaker2009" role="doc-biblioref">2009</a>)</span>. For a related model for the interaction between therapist and client, see <span class="citation" data-cites="tschacher2019">Tschacher and Haken (<a href="references.html#ref-tschacher2019" role="doc-biblioref">2019</a>)</span>.</p>
</section>
</section>
<section id="sec-The-van-Geert-models" class="level3 page-columns page-full" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="sec-The-van-Geert-models"><span class="header-section-number">4.3.3</span> The van Geert models</h3>
<div class="page-columns page-full"><p>In a series of papers, Paul van Geert proposed dynamical systems models for developmental processes <span class="citation" data-cites="denhartighDynamicNetworkModel2016 vangeertDynamicSystemsModel1998 vangeertDynamicSystemsModel1991">(<a href="references.html#ref-denhartighDynamicNetworkModel2016" role="doc-biblioref">Den Hartigh et al. 2016</a>; <a href="references.html#ref-vangeertDynamicSystemsModel1998" role="doc-biblioref">van Geert 1998</a>, <a href="references.html#ref-vangeertDynamicSystemsModel1991" role="doc-biblioref">1991</a>)</span>. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">It is thought that cognitive and language abilities grow over time in an autocatalytic process constrained by a limited capacity, similar to the logistic growth of populations.</span></div></div>
<p>Van Geert has proposed many different models, but I will give just one example. Van Geert <span class="citation" data-cites="vangeertDynamicSystemsModel1991">(<a href="references.html#ref-vangeertDynamicSystemsModel1991" role="doc-biblioref">1991</a>)</span> introduced a system of two coupled difference equations to model where the growth rate of one cognitive ability depends on the level of another cognitive ability:</p>
<p><span id="eq-ch4n-13-old-33"><span class="math display">\[
\begin{gathered}
X_{t + 1} = (a - bY_{t})X_{t} - \frac{aX_{t}^{2}}{K}, \\
Y_{t + 1} = (c - dX_{t})Y_{t} - \frac{cY_{t}^{2}}{K}.
\end{gathered}
\tag{4.12}\]</span></span></p>
<p>This can be implemented as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    dX <span class="ot">&lt;-</span> (a <span class="sc">+</span> b <span class="sc">*</span> Y) <span class="sc">*</span> X <span class="sc">-</span> a <span class="sc">*</span> X<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> K</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    dY <span class="ot">&lt;-</span> (c <span class="sc">+</span> d <span class="sc">*</span> X) <span class="sc">*</span> Y <span class="sc">-</span> c <span class="sc">*</span> Y<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> K</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dX, dY)))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  }) }</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameter values and run the model:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">K =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="fl">0.4</span>, <span class="at">b =</span> <span class="sc">-</span><span class="fl">0.05</span>, <span class="at">c =</span> .<span class="dv">4</span>, <span class="at">d =</span> <span class="sc">-</span><span class="fl">0.15</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">X =</span> <span class="fl">0.01</span>, <span class="at">Y =</span> <span class="fl">0.01</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">method =</span> <span class="st">"euler"</span>, <span class="at">tstep =</span> <span class="dv">1</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">portrait =</span> <span class="cn">TRUE</span>, <span class="at">grid=</span><span class="dv">4</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">K =</span> <span class="dv">1</span>, <span class="at">a =</span> <span class="fl">0.05</span>, <span class="at">b =</span> <span class="sc">-</span><span class="fl">0.1</span>,  <span class="at">c =</span> <span class="fl">0.05</span>, <span class="at">d =</span> <span class="sc">-</span><span class="fl">0.09</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">X =</span> <span class="fl">0.0126</span>, <span class="at">Y =</span> <span class="fl">0.01</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">tmax =</span> <span class="dv">1500</span>, <span class="at">method =</span> <span class="st">"euler"</span>, <span class="at">tstep =</span> <span class="dv">1</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">portrait =</span> <span class="cn">TRUE</span>, <span class="at">grid =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-ch4n-img11-old-59" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img11-old-59-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img11-old-59.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img11-old-59-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.11: The development of two interrelated cognitive abilities in one of the van Geert models. In the left case they coexist; in the right case one ability suppresses the other.
</figcaption>
</figure>
</div>
<p>So, there are basically two outcomes: either both grow, or one grows and suppresses the other (see <a href="#fig-ch4n-img11-old-59" class="quarto-xref">figure&nbsp;<span>4.11</span></a>). Note that the method is set to “Euler” to simulate difference equations.</p>
</section>
<section id="sec-The-Polya-Urn-model-of-the-third-source" class="level3 page-columns page-full" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="sec-The-Polya-Urn-model-of-the-third-source"><span class="header-section-number">4.3.4</span> The Pólya urn model of the third source</h3>
<div class="page-columns page-full"><p>Another type of discrete dynamical systems model is the Pólya urn model, which is relevant to understanding nonlinear developmental processes in psychology. <span class="citation" data-cites="molenaar1993">Molenaar, Boomsma, and Dolan (<a href="references.html#ref-molenaar1993" role="doc-biblioref">1993</a>)</span> propose the third-source hypothesis.  Based on a series of studies, <span class="citation" data-cites="gartnerThirdComponentCausing1990">Gärtner (<a href="references.html#ref-gartnerThirdComponentCausing1990" role="doc-biblioref">1990</a>)</span> concluded that 70—80% of the variation in body weight in inbred mice appears to be due to a third component that generates biological variability in addition to genetic and environmental influences.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">The third-source hypothesis proposes that the development of complex living systems is influenced by three sources of variation: genetic variation, environmental variation, and self-organizing processes.</span></div></div>
<p>A simple, and in my opinion insightful, dynamical model for this effect is the Pólya urn model <span class="citation" data-cites="mahmoudPolyaUrnModels2008">(<a href="references.html#ref-mahmoudPolyaUrnModels2008" role="doc-biblioref">Mahmoud 2008</a>)</span>. In this discrete dynamical model, we add marbles to an urn containing some red and blue marbles. We could start with two blue and one red marbles. We randomly take out a marble. If it is blue, we put it back with another blue marble. If it is red, we put it back and add a red marble. Initially, <span class="math inline">\(p(blue) = 2/3\)</span>, but what will happen to that probability over time when we have more and more marbles? Think about it for a moment.</p>
<div class="page-columns page-full"><p>My intuition was simply wrong, and in my experience, this is true for the vast majority of people. What happens is shown in <a href="#fig-ch4n-img12-old-60" class="quarto-xref">figure&nbsp;<span>4.12</span></a>. Each time you run the process, <span class="math inline">\(p(blue)\)</span> reaches a stable state, but the value of that state is random. What happens is that early (random) samples have a huge influence on the long-term dynamics. This creates a Matthew effect. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">The Matthew effect says that the rich get richer and the poor get poorer.</span></div></div>
<div id="fig-ch4n-img12-old-60" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img12-old-60-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img12-old-60_above.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img12-old-60-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.12: The Pólya urn model. A random marble is sampled and placed back with an extra marble of the same color. The evolution of the probability of picking a blue marble is unpredictable and converges to a random number. This mechanism may play a role in the Matthew effect.
</figcaption>
</figure>
</div>
<p><span class="citation" data-cites="saviWiringIntelligence2019">Savi et al. (<a href="references.html#ref-saviWiringIntelligence2019" role="doc-biblioref">2019</a>)</span> provide a developmental interpretation. Imagine a child receives a tennis racket for her birthday. First, she practices the backhand twice at home, but incorrectly. Then, during her first tennis lesson, her trainer demonstrates the correct backhand. She now has three experiences, two incorrect and one correct. Now, suppose her backhand development is based on a very simple learning schema. Whenever a backhand return is required, she samples from her earlier experiences, and the sampled backhand is then added to the set of earlier experiences. Thus the cumulation of experiences follows the Pólya urn scheme. While she has the potential to become a tennis master, her twin sister, who had less fortunate initial experiences, decides to quit tennis lessons within the first year. This model is consistent with many developmental theories (e.g., the critical period hypothesis), but these theories lack a formal approach.</p>
</section>
<section id="sec-The-panic-model" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="sec-The-panic-model"><span class="header-section-number">4.3.5</span> The panic model</h3>
<p>In recent years, we have been working on a model of panic disorder <span class="citation" data-cites="robinaughAdvancingNetworkTheory2019">(<a href="references.html#ref-robinaughAdvancingNetworkTheory2019" role="doc-biblioref">Robinaugh et al. 2019</a>)</span>. In theories of panic disorder, there is a reinforcing feedback loop between arousal and perceived threat. When an increase in arousal is perceived as a threat (e.g., a heart attack), arousal increases further. This “vicious cycle” results in a panic attack <span class="citation" data-cites="clarkCognitiveApproachPanic1986">(<a href="references.html#ref-clarkCognitiveApproachPanic1986" role="doc-biblioref">Clark 1986</a>)</span>. Thus, these theories posit two causal effects: an effect of perceived threat on arousal and an effect of arousal on perceived threat.</p>
<p>We will further assume that the effect of perceived threat on changes in arousal is essentially linear while the causal effect of arousal on perceived threat is nonlinear (S-shaped). For the argument, see <span class="citation" data-cites="robinaughAdvancingNetworkTheory2019">Robinaugh et al. (<a href="references.html#ref-robinaughAdvancingNetworkTheory2019" role="doc-biblioref">2019</a>)</span>. It could be argued that both are nonlinear, but this does not fundamentally change the qualitative behavior of the model. The central part of the model consists of two coupled differential equations:</p>
<p><span id="eq-ch4n-14-old-34"><span class="math display">\[
\begin{gathered}
\frac{dA}{dt} = - A + bT, \\
\frac{dT}{dt} = \frac{1}{1 + e^{- \alpha(A + \beta)}} - T.
\end{gathered}
\tag{4.13}\]</span></span></p>
<p>This looks a bit like the Romeo and Juliet model, but now the effect of arousal <span class="math inline">\(A\)</span> on the change in perceived threat <span class="math inline">\(T\)</span> is a logistic function that starts at 0 and grows to 1. The location is determined by <span class="math inline">\(\beta\)</span>, and the acceleration or steepness is determined by <span class="math inline">\(\alpha\)</span>.</p>
<p>An implementation and simple illustration is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    dA <span class="ot">&lt;-</span> <span class="sc">-</span>A <span class="sc">+</span> b <span class="sc">*</span> T  </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    dT <span class="ot">&lt;-</span> <span class="sc">-</span>T <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha <span class="sc">*</span> (A <span class="sc">+</span> beta)))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dA, dT)))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">b =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="dv">12</span>, <span class="at">beta =</span> <span class="sc">-</span>.<span class="dv">7</span>) </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="dv">0</span>, <span class="at">T =</span> <span class="dv">0</span>) </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># arousal increase for time t in 20:30, leads to panic, </span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># which after some time ('30 min') disappears</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">vector =</span> <span class="cn">TRUE</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">1</span>, <span class="at">ymax =</span> <span class="fl">1.1</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>) </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">s =</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="dv">0</span>, <span class="at">T =</span> <span class="dv">0</span>), <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">s =</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="fl">0.8</span>, <span class="at">T =</span> .<span class="dv">8</span>), <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">newton</span>(<span class="at">s =</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="dv">1</span>, <span class="at">T =</span> <span class="dv">1</span>), <span class="at">plot =</span> <span class="cn">TRUE</span>);</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">after=</span><span class="st">"if(t&gt;20&amp;t&lt;30)state[1]&lt;-1;state&lt;-state+rnorm(2,mean=0,sd=0.1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <span class="math inline">\(\beta\)</span> parameter is set so that the nonpanic mode dominates, but the panic mode is present (a metastable state). This state can be easily disturbed (see plane). For <span class="math inline">\(20 &lt; t &lt; 30\)</span>, arousal is set to a high value, resulting in a high perceived threat. But because we also added some noise to both processes, after some time both arousal and perceived threat jump back to low values.</p>
<p>This dynamic of this model is the cusp, as can be checked with (see <a href="#fig-ch4n-img15-old-63" class="quarto-xref">figure&nbsp;<span>4.15</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">b =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="dv">12</span>, <span class="at">beta =</span> <span class="sc">-</span>.<span class="dv">5</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">newton</span>(<span class="at">s =</span> <span class="fu">c</span>(<span class="at">A =</span> .<span class="dv">1</span>,  <span class="at">T=</span> .<span class="dv">1</span>)) </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">continue</span>(start, <span class="at">x =</span> <span class="st">"beta"</span>, <span class="at">y =</span> <span class="st">"T"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">1</span>, <span class="at">ymax =</span> <span class="dv">1</span>) </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">continue</span>(start, <span class="at">x =</span> <span class="st">"alpha"</span>, <span class="at">y =</span> <span class="st">"T"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">20</span>, <span class="at">ymax =</span> <span class="dv">1</span>) </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="fu">newton</span>(<span class="at">s =</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="dv">1</span>, <span class="at">T =</span> <span class="dv">1</span>)) <span class="co"># finds a minimum starting from X = -1</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">continue</span>(start, <span class="at">x =</span> <span class="st">"alpha"</span>, <span class="at">y =</span> <span class="st">"T"</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">20</span>, <span class="at">ymax =</span> <span class="dv">1</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <span class="citation" data-cites="robinaughAdvancingNetworkTheory2019">Robinaugh et al. (<a href="references.html#ref-robinaughAdvancingNetworkTheory2019" role="doc-biblioref">2019</a>)</span>, this model is extended with other processes, such as arousal and escape schemes, that operate on the parameters of the basic model. These are slower processes that are modeled on different time scales.</p>
<div id="fig-ch4n-img13-old-61" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img13-old-61-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img13-old-61.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img13-old-61-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.13: The panic model. Arousal is set high between time is 20 and 30, but panic persists due to the hysteresis effect. Eventually, due to noise, it escapes from the metastable attractor at <span class="math inline">\(A = T = 1\)</span>.
</figcaption>
</figure>
</div>
</section>
<section id="sec-Neural-models-van-der-Pol-and-different-time-scales" class="level3 page-columns page-full" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="sec-Neural-models-van-der-Pol-and-different-time-scales"><span class="header-section-number">4.3.6</span> Neural models: Van der Pol and different time scales</h3>
<div class="page-columns page-full"><p>In the panic model, we touched on differences in time scales.  Time scales are critical to understanding and managing complex systems because they allow fast dynamics to be separated from slow dynamics, thereby simplifying analysis and modeling. I will explain this further in the context of the van der Pol oscillator, which has many interesting applications.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">The difference in time scales refers to the different rates at which system components or processes evolve, affecting the overall behavior of the system.</span></div></div>
<p>Imagine taking the cusp equation <span class="math inline">\(dX/dt = {a + bX - X}^{3}\)</span>, with <span class="math inline">\(b=1\)</span>, such that we have hysteresis. But now we make <span class="math inline">\(a\)</span>, or actually <span class="math inline">\(da/dt\)</span>, a function of <span class="math inline">\(X\)</span>: <span class="math inline">\(da/dt = - \varepsilon X\)</span>, where <span class="math inline">\(\varepsilon\)</span> is small constant. If we set <span class="math inline">\(\varepsilon\)</span> to .05, <span class="math inline">\(a\)</span> changes 20 times slower than <span class="math inline">\(X\)</span>. What happens now is that with <span class="math inline">\(X = 1\)</span> and <span class="math inline">\(a = 0\)</span>, <span class="math inline">\(a\)</span> decreases up to the point where <span class="math inline">\(X\)</span> jumps to a negative value. Now <span class="math inline">\(a\)</span> increases, resulting to a new jump to a positive value of <span class="math inline">\(X\)</span>. And this loop will continue endlessly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms){</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)),{</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    dX <span class="ot">&lt;-</span>  a <span class="sc">+</span> b <span class="sc">*</span> X <span class="sc">-</span> X<span class="sc">^</span><span class="dv">3</span> <span class="co"># cusp</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    da <span class="ot">&lt;-</span> <span class="sc">-</span>e <span class="sc">*</span> X</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dX, da)))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">X =</span> .<span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>) <span class="co"># initial state and parameter values</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">e =</span> .<span class="dv">05</span>, <span class="at">b =</span> <span class="sc">-</span>.<span class="dv">5</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">ymin =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">main =</span> <span class="st">'b = -.5'</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">ymax =</span> <span class="dv">2</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">portrait =</span> <span class="cn">TRUE</span>, <span class="at">grid =</span> <span class="dv">2</span>, <span class="at">main=</span> <span class="st">'b = -.5'</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">e =</span> .<span class="dv">05</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">ymin =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">main =</span> <span class="st">'b = 1'</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plane</span>(<span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">ymax =</span> <span class="dv">2</span>, <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">portrait =</span> <span class="cn">TRUE</span>, <span class="at">grid =</span> <span class="dv">2</span>, <span class="at">main=</span> <span class="st">'b = 1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-ch4n-img14-old-62" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img14-old-62-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img14-old-62.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img14-old-62-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.14: Two runs of the van der Pol oscillator. For high b, this system oscillates between the two stables states of the cusp. The black dots represent different initial states.
</figcaption>
</figure>
</div>
<p>The plots (<a href="#fig-ch4n-img15-old-63" class="quarto-xref">figure&nbsp;<span>4.15</span></a>) illustrate this behavior. For <span class="math inline">\(b &lt; 0\)</span>, <span class="math inline">\(X\)</span> converges to a fixed point. For <span class="math inline">\(b &gt; 0\)</span>, we see cyclic jumps up and down. This oscillator is basically the famous van der Pol oscillator, originally written in the form:</p>
<p><span id="eq-ch4n-15-old-35"><span class="math display">\[
\frac{d^{2}X}{dt^{2}} = \mu\left( 1 - X^{2} \right)\frac{dX}{dt} + x.
\tag{4.14}\]</span></span></p>
<p>Such a second-order differential equation can be rewritten in the form of a first-order system of multiple equations, which is the form required for Grind.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> This model form is of (neuro)psychological interest because it relates to the FitzHugh—Nagumo model for neuronal excitability <span class="citation" data-cites="izhikevichFitzHughNagumoModel2006">(<a href="references.html#ref-izhikevichFitzHughNagumoModel2006" role="doc-biblioref">Izhikevich and FitzHugh 2006</a>)</span><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>:</p>
<p><span id="eq-ch4n-16-old-36"><span class="math display">\[
\begin{gathered}
\frac{dV}{dt} = V - \frac{V^{3}}{3} - W + I, \\
\frac{dW}{dt} = .08(V + .7 - .8W).
\end{gathered} \tag{4.15}\]</span></span></p>
<p>The equation for <span class="math inline">\(V\)</span>, the membrane potential, has a cubic nonlinearity that allows regenerative self-excitation via positive feedback. <span class="math inline">\(W\)</span>, a recovery variable, provides linear negative feedback. <span class="math inline">\(I\)</span> represents the input. The main phenomena in this model are shown in <a href="#fig-ch4n-img15-old-63" class="quarto-xref">figure&nbsp;<span>4.15</span></a>.</p>
<div id="fig-ch4n-img15-old-63" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img15-old-63-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/ch4-15-may31.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img15-old-63-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.15: The dynamics of the FitzHugh—Nagumo model. The horizontal axis represents the membrane potential (<span class="math inline">\(V\)</span>), which is the voltage across the membrane of a neuron. The vertical axis represents the recovery variable (<span class="math inline">\(W\)</span>). The <span class="math inline">\(V\)</span>-nullcline (where <span class="math inline">\(dV/dt = 0\)</span>) and the <span class="math inline">\(W\)</span>-nullcline (where <span class="math inline">\(dW/dt = 0\)</span>) cross at the unstable resting point. The lines with arrows represent typical trajectories. In the depolarized state, the membrane potential is higher than at rest, potentially leading to an action potential. In the hyperpolarized state, the membrane potential is lower than at rest. In the self-excitatory and regenerative phases, the system can increase its own activity without external input. The active region refers to a state in which the neuron is actively firing. Absolute and relative refractory are periods following an action potential when a neuron cannot fire again.
</figcaption>
</figure>
</div>
<p>This model is for a single neuron. Crucial is that second equation is a slow process. Time-scale effects also play an important role in learning in neural networks. In most neural networks, there is a fast equation for updating neuron activities and a much slower equation for updating the connection strengths.</p>
<p>Other applications of the van der Pol model concern extensions of the Haken–Kelso–Bunz (HKB) model (see <a href="ch5n.html#sec-Motor-action" class="quarto-xref"><span>Section 5.4.4</span></a>), multistable perception <span class="citation" data-cites="furstenauSimulatingBistablePerception2014">(<a href="references.html#ref-furstenauSimulatingBistablePerception2014" role="doc-biblioref">Fürstenau 2014</a>)</span>, developmental processes <span class="citation" data-cites="molenaarDynamicModelsDevelopment1985">(<a href="references.html#ref-molenaarDynamicModelsDevelopment1985" role="doc-biblioref">Molenaar and Oppenheimer 1985</a>)</span>, and bipolar disorder <span class="citation" data-cites="daughertyMathematicalModelsBipolar2009">(<a href="references.html#ref-daughertyMathematicalModelsBipolar2009" role="doc-biblioref">Daugherty et al. 2009</a>)</span>. One case where it seems especially useful is in modeling the wake—sleep cycle <span class="citation" data-cites="forgerSimplerModelHuman1999">(<a href="references.html#ref-forgerSimplerModelHuman1999" role="doc-biblioref">Forger, Jewett, and Kronauer 1999</a>)</span>.</p>
</section>
<section id="sec-Analogical-modeling-Budworms-and-Beers" class="level3 page-columns page-full" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored" data-anchor-id="sec-Analogical-modeling-Budworms-and-Beers"><span class="header-section-number">4.3.7</span> Analogical modeling: Budworms and beers</h3>
<p>If we create a dynamic model from the ground up, there’s a significant chance that we might not completely grasp its intricacies. We have seen that some very simple models already show amazingly complex behavior.</p>
<p>One approach to cope with these issues is analogical modeling, or basically copying models. For instance, we used the Ising model to model attitudes and the mutualistic Lotka—Volterra model to model intelligence. Both are explained in <a href="ch6.html" class="quarto-xref"><span>Chapter 6</span></a>. Here, I will use addiction as an example, focusing on a selection of key phenomena (and for now ignoring many others).</p>
<p>We have reviewed existing formal models of addiction in <span class="citation" data-cites="vandenendeReviewMathematicalModeling2022">van den Ende et al. (<a href="references.html#ref-vandenendeReviewMathematicalModeling2022" role="doc-biblioref">2022</a>)</span>. Most of these models are quite complicated. I want the model of the individual addict to be as simple as possible. The reasons for this will become clear in <a href="ch7.html" class="quarto-xref"><span>Chapter 7</span></a> when we include social effects <span class="citation" data-cites="bootIntegratingDualProcessInpreparation">(<a href="references.html#ref-bootIntegratingDualProcessInpreparation" role="doc-biblioref">Boot et al. submitted for publication</a>)</span>. The key phenomena are that initiation, cessation, and relapse are often discontinuous processes. The verbal theories we adapt are dual-process models in which an automatic process of using more and more is controlled by a non-automatic process, self-control.</p>
<p>Instead of creating our own model, we look for well-studied models in other sciences, which led me to the spruce budworm model:</p>
<p><span id="eq-ch4n-17-old-37"><span class="math display">\[
\frac{dN}{dt} = r_{b}N\left( 1 - \frac{N}{K} \right) - \frac{BN^{2}}{A^{2} + N^{2}}.
\tag{4.16}\]</span></span></p>
<p>But now we interpret the variables and parameters as follows. We first assume <span class="math inline">\(N\)</span> is the number of drinks you consume. The time scale is a day or an evening (depending on when you have your first beer). <span class="math inline">\(K\)</span> is the upper limit of drinks you can take, either because of lack of availability or, worse, because you just collapse. <span class="math inline">\(r_{b}\)</span> is the addiction sensitivity. If this is too low (<span class="math inline">\(r_{b} &lt; 0\)</span>), the 0 state is stable. The logistic function seems to be a reasonable choice. Drinking might start off slow, then accelerate, and level off at <span class="math inline">\(K\)</span>. This happens when there is only an autonomous process. The second term, the predator term, is now interpreted as self-control. This is not something that changes on the time scale of a day, so, as in the case of the birds, a second equation is not required. <span class="math inline">\(A\)</span> (or actually <span class="math inline">\(1/A\)</span>) is a responsiveness parameter, the number of drinks at which self-control is activated, which may not be at the first or second beer. <span class="math inline">\(B\)</span> is the maximum level of self-control. As in the original model, this term is a Holling type III form (see <a href="#fig-ch4n-img5-old-53" class="quarto-xref">figure&nbsp;<span>4.5</span></a>). We could also insert a Holling type IV form, with the idea that self-control deteriorates after too many drinks. Depending on the values of the parameters, one may not drink at all (<span class="math inline">\(r_{b} &lt; 0\)</span>), drink at a recreational level, or have an “outbreak” to heavy use.</p>
<p>The advantage of this type of analogical modeling is that we already know everything about the model. We know it is a cusp, and we have already made the bifurcation diagram. There are also disadvantages or ambiguities.</p>
<p>First, the definition of <span class="math inline">\(N\)</span> is imprecise. Is it the blood alcohol concentration, the number of drinks, or some other quantity?</p>
<p>Second, the choice of a logistic function for the autonomous part seems reasonable but is not derived from first principles. One could also assume a linear function with a ceiling at <span class="math inline">\(K\)</span>.</p>
<p>Third, and relatedly, the self-control function is also not derived from first principles. An additional problem is that we cannot measure this term directly <span class="citation" data-cites="duckworth2014">(<a href="references.html#ref-duckworth2014" role="doc-biblioref">Duckworth and Gross 2014</a>)</span>.</p>
<p>Fourth, this model may not work for all addictions or should be adapted to specific cases. An example is smoking. For smoking, the intermediate recreational state is very unstable <span class="citation" data-cites="epskampIntermediateStableStates2022">(<a href="references.html#ref-epskampIntermediateStableStates2022" role="doc-biblioref">Epskamp et al. 2022</a>)</span>, and the autocatalytic effect described by the logistic equation seems less appropriate. For alcohol, the Holling type IV seems to be a good choice for the self-control term as alcohol directly impairs brain regions involved in self-control <span class="citation" data-cites="remmerswaalImpairedSubjectiveSelfcontrol2019">(<a href="references.html#ref-remmerswaalImpairedSubjectiveSelfcontrol2019" role="doc-biblioref">Remmerswaal et al. 2019</a>)</span>. For gambling, Holling Type III may be sufficient.</p>
<div class="page-columns page-full"><p>Fifth, processes at other time scales are missing. The model seems to work well for the time scale of a day or an evening. Other relevant time scales are minutes (direct effect of alcohol intake on the brain), weeks (abuse is often concentrated on weekends), and months. On time scales of months or even years, the parameters <span class="math inline">\(r_{b}\)</span>, <span class="math inline">\(K\)</span>, and <span class="math inline">\(B\)</span> may change. For example, experienced drinkers can drink more. Also, the <span class="math inline">\(r_{b}\)</span>, addiction sensitivity, may slowly increase over time. This can be taken into account with additional equations. Furthermore, <span class="math inline">\(K\)</span>, <span class="math inline">\(A\)</span>, and <span class="math inline">\(B\)</span> could change as an effect of the social network. Nondrinkers might increase <span class="math inline">\(A\)</span>, while other users in the social network might increase <span class="math inline">\(K\)</span> (availability). These modeling issues are serious but also very interesting <span class="citation" data-cites="vandongen2024">(<a href="references.html#ref-vandongen2024" role="doc-biblioref">Dongen et al. 2024</a>)</span>. </p><div class="no-row-height column-margin column-container"><span class="margin-aside">Ambiguities in our thinking about psychological systems come to light in the process of building concrete mathematical models.</span></div></div>
</section>
<section id="sec-Cascading-transitions-in-multifigure-multistable-perception" class="level3 page-columns page-full" data-number="4.3.8">
<h3 data-number="4.3.8" class="anchored" data-anchor-id="sec-Cascading-transitions-in-multifigure-multistable-perception"><span class="header-section-number">4.3.8</span> Cascading transitions in multifigure multistable perception</h3>
<section id="sec-Interacting-cusps" class="level4 page-columns page-full" data-number="4.3.8.1">
<h4 data-number="4.3.8.1" class="anchored" data-anchor-id="sec-Interacting-cusps"><span class="header-section-number">4.3.8.1</span> Interacting cusps</h4>
<p>In <a href="#sec-Neural-models-van-der-Pol-and-different-time-scales" class="quarto-xref"><span>Section 4.3.6</span></a>, we studied the van der Pol oscillator. In that model the normal variable of the cusp was itself a dynamic variable <span class="math inline">\(\frac{da}{dt}= - \varepsilon X\)</span>. Instead of a linear equation, we could also use a cusp. We then get:</p>
<p><span id="eq-ch4n-18-old-38"><span class="math display">\[
\begin{gathered}
\frac{dX}{dt} = {aY + bX - X}^{3}, \\
\frac{dY}{dt} = {cX + dY - Y}^{3}.
\end{gathered}
\tag{4.17}\]</span></span></p>
<p>This model, first proposed by Kadyrov, was analyzed in detail by <span class="citation" data-cites="abrahamComputationalUnfoldingDoublecusp1991">Abraham et al. (<a href="references.html#ref-abrahamComputationalUnfoldingDoublecusp1991" role="doc-biblioref">1991</a>)</span>. We can study this model in Grind by specifying:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)), {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    dX <span class="ot">&lt;-</span> a <span class="sc">*</span> Y <span class="sc">+</span> b <span class="sc">*</span> X <span class="sc">-</span> X<span class="sc">^</span><span class="dv">3</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    dY <span class="ot">&lt;-</span> c <span class="sc">*</span> X <span class="sc">+</span> d <span class="sc">*</span> Y <span class="sc">-</span> Y<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dX, dY))) </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Depending on the choice of the parameters and initial values, many different things can happen. <span class="citation" data-cites="abrahamComputationalUnfoldingDoublecusp1991">Abraham et al. (<a href="references.html#ref-abrahamComputationalUnfoldingDoublecusp1991" role="doc-biblioref">1991</a>)</span> created bifurcation diagrams to summarize the qualitatively different regimes. We will restrict ourselves to the case where <span class="math inline">\(b = d = 1\)</span>, and <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> are varied. The bifurcation diagrams and associated phase planes are shown in <a href="#fig-ch4n-img16-old-64" class="quarto-xref">figure&nbsp;<span>4.16</span></a>.</p>
<div id="fig-ch4n-img16-old-64" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img16-old-64-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img16-old-64_above.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img16-old-64-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.16: On the left the bifurcation diagram for the double cusp (<span class="math inline">\(b = d = 1\)</span>) is shown. The figures on the right show the phase planes associated with the four different cases in the bifurcation diagram. Case a has 9 fixed points, 4 of which are stable. Case b has 5 fixed points, 2 of which are stable. Case c has 3 fixed points, 2 of which are stable. Case d is special because it has a limit cycle, the Kadyrov oscillator.
</figcaption>
</figure>
</div>
<p>The phase planes of <a href="#fig-ch4n-img16-old-64" class="quarto-xref">figure&nbsp;<span>4.16</span></a> can be made with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">X =</span> <span class="dv">0</span>, <span class="at">Y =</span> <span class="dv">0</span>) </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>,<span class="st">'d'</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="st">'a'</span>) p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> .<span class="dv">3</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> .<span class="dv">3</span>, <span class="at">d =</span> <span class="dv">1</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="st">'b'</span>) p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> .<span class="dv">6</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> .<span class="dv">6</span>, <span class="at">d =</span> <span class="dv">1</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="st">'c'</span>) p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> <span class="dv">1</span>, <span class="at">d =</span> <span class="dv">1</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="st">'d'</span>) p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">d =</span> <span class="dv">1</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plane</span>(<span class="at">tstep =</span> <span class="fl">0.5</span>, <span class="at">portrait =</span> (i <span class="sc">==</span> <span class="st">'d'</span>), <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">ymax =</span> <span class="dv">2</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="dv">2</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Case "</span>, i)) <span class="co"># make a phase portrait (Fig 1c)</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">!=</span> <span class="st">'d'</span>) <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>) </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">newton</span>(<span class="fu">c</span>(<span class="at">X =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">Y =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)), <span class="at">plot =</span> <span class="cn">TRUE</span>) </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">newton</span>(<span class="fu">c</span>(<span class="at">X =</span> <span class="dv">0</span>, <span class="at">Y =</span> <span class="dv">0</span>), <span class="at">plot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">X =</span> <span class="fl">0.1</span>, <span class="at">Y =</span> .<span class="dv">1</span>) </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">d =</span> <span class="dv">1</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">tmax =</span> <span class="dv">20</span>, <span class="at">tstep =</span> <span class="fl">0.1</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">ymax =</span> <span class="dv">2</span>) <span class="co"># Kadyrov oscillator</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last three lines of this code show the Kadyrov oscillator (<a href="#fig-ch4n-img17-old-65" class="quarto-xref">figure&nbsp;<span>4.17</span></a>).</p>
<div id="fig-ch4n-img17-old-65" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img17-old-65-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img17-old-65.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img17-old-65-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.17: The Kadyrov oscillator. Y attracts X to its state (as <span class="math inline">\(d = 1\)</span>), but X pushes Y away (as <span class="math inline">\(c = - 1\)</span>), resulting in oscillations.
</figcaption>
</figure>
</div>
<p>If we simplify this analysis a bit to stable fixed points only, we see three regimes:</p>
<ul>
<li><p>Case a (weak interactions): Each cusp has two stable states. The combination of a negative and a positive state is possible because the interaction strength <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> are too weak.</p></li>
<li><p>Case b and c (strong interactions): The combination of a negative and a positive state is now impossible because the interaction strengths <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> are too strong. The equilibria <span class="math inline">\(X\)</span>* and <span class="math inline">\(Y\)</span>* are both positive or both negative.</p></li>
<li><p>Case d (opposite interactions): <span class="math inline">\(a\)</span> and <span class="math inline">\(c\)</span> have opposite signs, leading to oscillations.</p></li>
</ul>
<p><span class="citation" data-cites="abrahamComputationalUnfoldingDoublecusp1991">Abraham et al. (<a href="references.html#ref-abrahamComputationalUnfoldingDoublecusp1991" role="doc-biblioref">1991</a>)</span> generalize the model to:</p>
<p><span id="eq-ch4n-18-old-39"><span class="math display">\[
\begin{gathered}
\frac{dX}{dt} = {a_{0} + a_{1}Y + (b_{0} + b_{1}Y)X - X}^{3}, \\
\frac{dY}{dt} = {c_{0} + c_{1}X + \left( d_{0} + d_{1}X \right)Y - Y}^{3}.
\end{gathered}
\tag{4.18}\]</span></span></p>
<p>such that now both the splitting and normal variable of the cusp are linear functions of the behavioral state of the other cusp. This can be further generalized to a system of <span class="math inline">\(N\)</span> cusps by:</p>
<p><span id="eq-ch4n-20-old-40"><span class="math display">\[
\frac{dX_{i}}{dt} = a_{0i} + \sum_{j\neq i}^{}{a_{ij}X_{j}} + b_{0i}X_{i} + \sum_{j\neq i}^{}{b_{ij}X_{i}X_{j}} - {X_{i}}^{3}.
\tag{4.19}\]</span></span></p>
<p>In this model, <span class="math inline">\(a_{0i}\)</span> is the intercept of the normal variable and the off-diagonal elements of matrix <span class="math inline">\(a\)</span> are the slopes of the effect of the other cusps on the normal variable. The diagonal elements of <span class="math inline">\(a\)</span> are set to 0. The <span class="math inline">\(b_{0i}\)</span> values are the intercepts of the splitting variable. The <span class="math inline">\(b_{ij}\)</span> values of matrix <span class="math inline">\(b\)</span> (with diagonal = 0) are the slopes of the effect of other cusps on the splitting variable value of <span class="math inline">\(X_{i}\)</span>.</p>
<div class="page-columns page-full"><p>The cascading transition model has been proposed independently in various research areas. The idea of cuspoidal nets (<span class="math inline">\(N&gt;3\)</span>) as a neural network has been mentioned in <span class="citation" data-cites="abrahamCuspoidalNets1991">Abraham (<a href="references.html#ref-abrahamCuspoidalNets1991" role="doc-biblioref">1991</a>)</span> and analyzed in <span class="citation" data-cites="hoffmannTeachableNeuralNetwork1986">Hoffmann et al. (<a href="references.html#ref-hoffmannTeachableNeuralNetwork1986" role="doc-biblioref">1986</a>)</span> and <span class="citation" data-cites="izhikevichMultipleCuspBifurcations1This1998">Izhikevich (<a href="references.html#ref-izhikevichMultipleCuspBifurcations1This1998" role="doc-biblioref">1998</a>)</span>. <span class="citation" data-cites="castroArtificialImmuneSystems2003">Castro and Timmis (<a href="references.html#ref-castroArtificialImmuneSystems2003" role="doc-biblioref">2003</a>)</span> discuss this model in the context of adaptive immune systems. The most recent application is in climate research <span class="citation" data-cites="dekkerCascadingTransitionsClimate2018 vonderheydtCascadingTransitionsClimate2019 kloseEmergenceCascadingDynamics2020">(<a href="references.html#ref-dekkerCascadingTransitionsClimate2018" role="doc-biblioref">Dekker, von der Heydt, and Dijkstra 2018</a>; <a href="references.html#ref-vonderheydtCascadingTransitionsClimate2019" role="doc-biblioref">von der Heydt, Dekker, and Dijkstra 2019</a>; <a href="references.html#ref-kloseEmergenceCascadingDynamics2020" role="doc-biblioref">Klose et al. 2020</a>)</span>.  The applications involve special cases of <a href="#eq-ch4n-20-old-40" class="quarto-xref">equation&nbsp;<span>4.19</span></a>, such as the case where one cusp influences the other, but not vice versa. To my knowledge, the case where <span class="math inline">\(b_{ij} \neq 0\)</span> has not been applied. A recent related approach using coupled van der Pol oscillators is described in <span class="citation" data-cites="monsivais-velazquezDynamicsHierarchicalWeighted2020">Monsivais-Velazquez et al. (<a href="references.html#ref-monsivais-velazquezDynamicsHierarchicalWeighted2020" role="doc-biblioref">2020</a>)</span>.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">The idea of a cascade of collapsing subsystems in the climate is a frightening one.</span></div></div>
<p>I will give a psychological example of this multivariate model, concerning perception, in the next section.</p>
</section>
<section id="sec-Application-to-perception" class="level4" data-number="4.3.8.2">
<h4 data-number="4.3.8.2" class="anchored" data-anchor-id="sec-Application-to-perception"><span class="header-section-number">4.3.8.2</span> Application to perception</h4>
<p>Take a look at <a href="#fig-ch4n-img18-old-66" class="quarto-xref">figure&nbsp;<span>4.18</span></a>. This is a special case of multistable perception, which I call multifigure multistable perception.</p>
<div id="fig-ch4n-img18-old-66" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img18-old-66-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/image18.jpg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img18-old-66-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.18: Multifigure multistable perception. Verify three phenomena: (1) some attention or focus is required to see three-dimensional cubes, (2) spontaneous transitions in the perception of cubes occur, (3) such transitions affect the perception of neighboring cubes.
</figcaption>
</figure>
</div>
<p>We can build a dynamical systems model of these perceptual phenomena by using the cascading transition model setup. We define <span class="math inline">\(X\)</span> as the percept of the cube. <span class="math inline">\(X = 0\)</span> means that no cubes are perceived, only lines and colored parallelograms. <span class="math inline">\(X &gt; 0\)</span> represents the front view, and <span class="math inline">\(X &lt; 0\)</span> the back view (cf. <a href="ch3.html#fig-ch3-img2-old-14" class="quarto-xref">fig.&nbsp;<span>3.2</span></a>). The cusp model for one cube is <span class="math inline">\(\frac{dX}{dt} = {a + bX - X}^{3}\)</span>, where <span class="math inline">\(a\)</span> is the bias parameter and <span class="math inline">\(b\)</span> is the attention parameter. If <span class="math inline">\(a = 0\)</span> and <span class="math inline">\(b &gt; 1\)</span> (no bias and some attention to the figure), we get bistable percepts and spontaneous switches in perception (assuming we add some noise; see <a href="#fig-ch4n-img2-old-50" class="quarto-xref">figure&nbsp;<span>4.2</span></a>).</p>
<p>Now we apply <a href="#eq-ch4n-20-old-40" class="quarto-xref">equation&nbsp;<span>4.19</span></a>. We have <span class="math inline">\(N = 25\)</span> (a bit depending on how you count). The values of the parameters <span class="math inline">\(a_{0i}\)</span> should be estimated from data, but for now we will assume no bias, so <span class="math inline">\(a_{0i} = 0\)</span>. We set <span class="math inline">\(a_{ij} &gt; 0\)</span>, meaning that we expect positive coupling between the cusps. We set <span class="math inline">\(b_{ij} &gt; 0\)</span>, based on the idea that three-dimensional perception in one cube increases attention in the other cubes. The <span class="math inline">\(b_{0}\)</span> is the attention vector. In the simulation we first assume that attention is low (<span class="math inline">\(b_{0i} = -0.3)\)</span>. After an initial phase, we will set <span class="math inline">\(b_{01} = 1\)</span>, that is we suddenly attend to one cube. A bit later we set <span class="math inline">\(b_{01}\)</span> back to <span class="math inline">\(-0.3\)</span>.</p>
<p>To make this model work, we need to make one adjustment. We replace <span class="math inline">\(\sum_{j \neq i}^{}{b_{ij}X_{i}X_{j}}\)</span> with <span class="math inline">\(\sum_{j \neq i}^{}{b_{ij}X_{i}|X_{j}|}\)</span>.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> This is because the increase in attention by the three-dimensional perception of neighboring cubes does not depend on whether we perceive the front or the back view. Thus, the model for multifigure multistable perception is:</p>
<p><span id="eq-ch4n-21-old-41"><span class="math display">\[
\frac{dX_{i}}{dt} = a_{0i} + \sum_{j \neq i}^{}{a_{ij}X_{j}} + b_{0i}X_{i} + \sum_{j \neq i}^{}{b_{ij}X_{i}\left| X_{j} \right|} - {X_{i}}^{3}.
\tag{4.20}\]</span></span></p>
<p>The code to simulate this model is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parms){</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(state, parms)),{</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> state[<span class="dv">1</span><span class="sc">:</span>N]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    b0_i <span class="ot">&lt;-</span> parms[<span class="dv">1</span><span class="sc">:</span>N]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    dX <span class="ot">&lt;-</span> <span class="sc">-</span>X<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> a0_i <span class="sc">+</span> a_ij <span class="sc">%*%</span> X <span class="sc">+</span> b0_i<span class="sc">*</span>X <span class="sc">+</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>      (X <span class="sc">*</span> b_ij <span class="sc">%*%</span>  <span class="fu">abs</span>(X))  <span class="co"># note abs(X)</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(dX))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># 10 necker cubes</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(N, <span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span>) <span class="co"># initial state of X</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>a0_i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N) <span class="co"># no  bias in percepts</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>a_ij <span class="ot">&lt;-</span> <span class="fu">matrix</span>(.<span class="dv">02</span>, N, N) <span class="co"># small couplings (normal)</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(a_ij) <span class="ot">&lt;-</span>  <span class="dv">0</span> <span class="co"># set diagonal of a to 0</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>b0_i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="sc">-</span>.<span class="dv">3</span>, N) <span class="co"># attention initially low</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>b_ij <span class="ot">&lt;-</span> <span class="fu">matrix</span>(.<span class="dv">2</span>, N, N) <span class="co"># some spread of attention (splitting)</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(b_ij) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># set diagonal of b to 0</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> X; p <span class="ot">&lt;-</span> <span class="fu">c</span>(b0_i) <span class="co"># required for grind</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">run</span>(<span class="at">after =</span> <span class="st">"if(t == 33) parms &lt;- c(1, rep(-.3, N-1));</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="st">            if(t == 66) parms &lt;- rep(-.3, N);</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="st">            state &lt;- state + rnorm(N, mean = 0, sd = 0.05)"</span>,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">ymax =</span> <span class="fl">2.5</span>, <span class="at">main =</span> <span class="st">''</span>, <span class="at">ylab =</span> <span class="st">'X'</span>, <span class="at">legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>b0_i <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="sc">-</span>.<span class="dv">3</span>, <span class="dv">100</span>); b0_i[<span class="dv">34</span><span class="sc">:</span><span class="dv">66</span>] <span class="ot">=</span> <span class="dv">1</span> <span class="co"># for plotting attention</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(b0_i, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">80</span>, <span class="fl">1.4</span>, <span class="st">'Percepts'</span>)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">80</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="st">'Attention'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which gives <a href="#fig-ch4n-img19-old-67" class="quarto-xref">figure&nbsp;<span>4.19</span></a>.</p>
<div id="fig-ch4n-img19-old-67" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img19-old-67-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/fig-ch4n-img19-old-67.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img19-old-67-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.19: The multifigure Necker cube simulation. Initially, attention is low and the percept is close to 0, representing the absence of three-dimensional perception. At <span class="math inline">\(t = 30\)</span>, the attention intercept to one cube is increased to 1. At <span class="math inline">\(t = 60\)</span>, it is set back to its initial low value. However, this one cube is now perceived as a cube, and the perception spreads to other cubes. They also increase overall attention, so that the perception of cubes continues after <span class="math inline">\(t = 60\)</span>.
</figcaption>
</figure>
</div>
<p>There is much more to be said about this model and its empirical validation. One idea is to look at different stimuli like the one in <a href="#fig-ch4n-img20-old-68" class="quarto-xref">figure&nbsp;<span>4.20</span></a>.</p>
<div id="fig-ch4n-img20-old-68" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img20-old-68-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/ch4n-20__figure69.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img20-old-68-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.20: Two embedded Necker cubes. The one on the left seems to have a positive coupling <span class="math inline">\(a_{ij} &gt; 0\)</span>, while the one on the right seems to switch independently (<span class="math inline">\(a_{ij} = 0)\)</span>. You can verify this introspectively. <span class="citation" data-cites="adamsEffectOrientationReversal1959">(Adapted from <a href="references.html#ref-adamsEffectOrientationReversal1959" role="doc-biblioref">Adams and Haire 1959</a>)</span>
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="sec-Causal-loop-diagrams" class="level2 page-columns page-full" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-Causal-loop-diagrams"><span class="header-section-number">4.4</span> Causal-loop diagrams</h2>
<div class="page-columns page-full"><p>One popular approach to dynamical systems modeling that I haven’t touched on is the use of causal-loop diagrams, as developed in the field of systems dynamics <span class="citation" data-cites="forresterSystemDynamicsLessons1993 meadowsThinkingSystemsPrimer2008">(<a href="references.html#ref-forresterSystemDynamicsLessons1993" role="doc-biblioref">Forrester 1993</a>; <a href="references.html#ref-meadowsThinkingSystemsPrimer2008" role="doc-biblioref">Meadows 2008</a>)</span>.  As <span class="citation" data-cites="crielaardRefiningCausalLoop2022">Crielaard et al. (<a href="references.html#ref-crielaardRefiningCausalLoop2022" role="doc-biblioref">2022</a>)</span> argue, the step from verbal theory to formal model may require an intermediate step of setting up a diagram that specifies the causal relationships between variables. Related to causal-loop diagrams are several dedicated software packages for system dynamics analysis.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">Causal- loop diagrams are visual tools used in systems thinking and system dynamics to represent the feedback loops and causal relationships within a system.</span></div></div>
<p>Insightmaker <span class="citation" data-cites="fortmann-roeInsightMakerGeneralpurpose2014">(<a href="references.html#ref-fortmann-roeInsightMakerGeneralpurpose2014" role="doc-biblioref">Fortmann-Roe 2014</a>)</span> is a simple free online tool that provides a graphical model construction interface for dynamical systems modeling and agent-based modeling. As such, it can be used to implement the models of this and the previous chapter. A Lotka—Volterra example is shown in <a href="#fig-ch4n-img21-old-69" class="quarto-xref">figure&nbsp;<span>4.21</span></a>. Insightmaker is easy to use. Studying some examples, found with “Explore Insights,” may suffice. I have added some models to Insightmaker discussed in this chapter with the tag “vdmaas.”</p>
<div id="fig-ch4n-img21-old-69" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch4n-img21-old-69-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="media/ch4n/ch4-21-june14.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch4n-img21-old-69-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.21: Screenshots of the Lotka—Volterra model in Insightmaker.
</figcaption>
</figure>
</div>
<p>Insightmaker has many powerful built-in functions and allows sensitivity testing as well as some sort of optimization. Personally, I prefer the approach of writing the equations and implementing them in R for several reasons. One is that this is how you communicate models in papers. Another is that the equations help you think about analytical results, which are always preferable to simulations. Finally, we can use Grind or deBif to go beyond simple simulations and classify equilibria and perform bifurcation analysis. But for building causal-loop diagrams of larger models to concretize theorizing without the direct goal of running them, Insightmaker is a great tool.</p>
</section>
<section id="sec-Closing-Remarks" class="level2 page-columns page-full" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-Closing-Remarks"><span class="header-section-number">4.5</span> Closing remarks</h2>
<p>In this chapter I focused on the construction of dynamical system models and introduced R tools to study them numerically. This introduction was necessarily somewhat superficial. At the beginning of this chapter, I referred to some texts that I recommend for further reading. The knowledge you now have will allow you to study existing models from different fields and to collaborate with experts in dynamical modeling. You now have the basic language for communicating about such models.</p>
<div class="page-columns page-full"><p>But even when you work with experts in dynamic modeling, building useful models is far from easy. I recommend following, at least roughly, the steps we proposed in our theory construction methodology <span class="citation" data-cites="borsboomTheoryConstructionMethodology2021">(<a href="references.html#ref-borsboomTheoryConstructionMethodology2021" role="doc-biblioref">Borsboom et al. 2021</a>)</span>.  This methodology requires a good knowledge of existing verbal theories and, if they exist, alternative formal models. I find the process of formalizing a verbal theory or model fascinating. It tends to be very confusing. Suddenly it is unclear what the basic assumptions are, what mechanism is really being proposed in some psychological theory, and what the time scales actually are.</p><div class="no-row-height column-margin column-container"><span class="margin-aside">The key is to formulate phenomena, replicated recurring patterns in data, that need to be explained.</span></div></div>
<p>As an example, I mention the well-known investment theory of <span class="citation" data-cites="cattellIntelligenceItsStructure1987">Cattell (<a href="references.html#ref-cattellIntelligenceItsStructure1987" role="doc-biblioref">1987</a>)</span>. Cattell’s investment theory posits that fluid intelligence, which represents the ability to solve novel problems, “invests” in crystallized intelligence, which consists of acquired knowledge and skills. I knew this theory for a long time before I tried to translate it into dynamical equations. But it was not so easy. I began to wonder why it was called an investment theory in the first place. When you invest in something, it becomes less at first but more in the future. Is that really what Cattell meant? The phenomena, the data patterns, suggest something else, because fluid intelligence grows rapidly and declines slowly after adolescence. Crystallized intelligence grows more slowly, but never really declines. It is unclear where the return on investment is. I would not argue that Cattell’s theory is nonsense, and a possible model is proposed in the Chapter 6 (<a href="ch6.html#sec-Abnormal-development" class="quarto-xref"><span>Section 6.3.1.3</span></a>), but this illustrates that the process of formalization is itself a test for verbal theories.</p>
<p>There are some more psychological models that I could have included. For example, the setup of dynamical field theory is a bit too complicated to replicate in Grind, but I recommend studying this model <span class="citation" data-cites="schonerDynamicThinkingPrimer2016">(<a href="references.html#ref-schonerDynamicThinkingPrimer2016" role="doc-biblioref">Schöner and Spencer 2016</a>)</span>. In Chapter 6, I present a dynamical model of developmental processes with mutualistic (positive) interactions (<a href="ch6.html#sec-Mutualism-model" class="quarto-xref"><span>Section 6.3.1.2</span></a>) and in <a href="ch7.html" class="quarto-xref"><span>Chapter 7</span></a> I introduce dynamical systems models of social interactions. I will discuss the modeling of dynamical systems in psychology further in the Epilogue to this book.</p>
</section>
<section id="sec-Exercises-ch4n" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="sec-Exercises-ch4n"><span class="header-section-number">4.6</span> Exercises</h2>
<ol type="1">
<li><p>Put the logistic equation into Grind, find out what the equilibria are, and determine for which values of <span class="math inline">\(r\)</span> these are stable or unstable fixed points. (*)</p></li>
<li><p>Check this analytically: Which are the two equilibria X*? For which values of <span class="math inline">\(r\)</span> are these fixed points stable? Does your result agree with the results of the previous exercise? (**)</p></li>
<li><p>Create the logistic map in Grind. Plot the time series for <span class="math inline">\(r = 4\)</span>. (*)</p></li>
<li><p>Make a plot of the pitchfork bifurcation, analogous to <a href="#fig-ch4n-img3-old-51" class="quarto-xref">figure&nbsp;<span>4.3</span></a> (*)</p></li>
<li><p>Use the spruce budworm model from <a href="#sec-Spruce-Budworm-outbreak-model" class="quarto-xref"><span>Section 4.2.6</span></a> and the <code>bifurcation()</code> function of the deBif package to recreate the bifurcation diagram shown in <a href="ch3.html#fig-ch3-img16-old-28" class="quarto-xref">figure&nbsp;<span>3.16</span></a>. Describe what you did and present the resulting figure. (**)</p></li>
<li><p>Implement the SIR model for infectious diseases in R using Grind. Reproduce the diagram of the SIR model with <span class="math inline">\(\beta = 0.4\)</span> and <span class="math inline">\(\gamma = 0.04\)</span> on the Wikipedia page on “Compartmental Models in Epidemiology.”</p></li>
<li><p>Reproduce the times-series plot of the simulation of the Pólya urn model shown in <a href="#fig-ch4n-img12-old-60" class="quarto-xref">figure&nbsp;<span>4.12</span></a>. (**)</p></li>
<li><p>Implement the FitzHugh—Nagumo model in Grind and replicate the <a href="#fig-ch4n-img15-old-63" class="quarto-xref">figure&nbsp;<span>4.15</span></a>. Exact replication is not required, but the phase diagram should look similar. (**)</p></li>
<li><p>Use Insightmaker to create a causal-loop diagram of the Romeo and Juliet model. Reproduce the case where the couple ends up in a shrinking cycle of hate and love (damping oscillator, second case of <a href="#fig-ch4n-img9-old-57" class="quarto-xref">figure&nbsp;<span>4.9</span></a>). Submit the simulation plot. (**)</p></li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-abrahamCuspoidalNets1991" class="csl-entry" role="listitem">
Abraham, Ralph. 1991. <span>“Cuspoidal <span>Nets</span>.”</span> In <em>Business <span>Cycles</span>: <span>Theories</span>, <span>Evidence</span> and <span>Analysis</span></em>, edited by Niels Thygesen, Kumaraswamy Velupillai, and Stefano Zambelli, 56–63. International <span>Economic Association</span>. <span>London</span>: <span>Palgrave Macmillan UK</span>. <a href="https://doi.org/10.1007/978-1-349-11570-9_3">https://doi.org/10.1007/978-1-349-11570-9_3</a>.
</div>
<div id="ref-abrahamComputationalUnfoldingDoublecusp1991" class="csl-entry" role="listitem">
Abraham, Ralph, Alexander Keith, Matthew Koebbe, and Gottfried Mayer-Kress. 1991. <span>“Computational Unfolding of Double-Cusp Models of Opinion Formation.”</span> <em>International Journal of Bifurcation and Chaos</em> 01 (02): 417–30. <a href="https://doi.org/10.1142/S0218127491000324">https://doi.org/10.1142/S0218127491000324</a>.
</div>
<div id="ref-abramsNaturePredationPrey2000" class="csl-entry" role="listitem">
Abrams, Peter A., Lev R. Ginzburg, Peter A. Abrams, Lev R. Ginzburg, Peter A. Abrams, and Lev R. Ginzburg. 2000. <span>“The Nature of Predation: Prey Dependent, Ratio Dependent or Neither?”</span> <em>Trends in Ecology &amp; Evolution</em> 15 (8): 337–41. <a href="https://doi.org/10.1016/S0169-5347(00)01908-X">https://doi.org/10.1016/S0169-5347(00)01908-X</a>.
</div>
<div id="ref-adamsEffectOrientationReversal1959" class="csl-entry" role="listitem">
Adams, Pauline, and Mason Haire. 1959. <span>“The Effect of Orientation on the Reversal of One Cube Inscribed in Another.”</span> <em>The American Journal of Psychology</em> 72: 296–99. <a href="https://doi.org/10.2307/1419384">https://doi.org/10.2307/1419384</a>.
</div>
<div id="ref-ainsworthPatternsAttachmentPsychological2015" class="csl-entry" role="listitem">
Ainsworth, Mary D. Salter, Mary C. Blehar, Everett Waters, and Sally N. Wall. 2015. <em>Patterns of <span>Attachment</span>: <span>A Psychological Study</span> of the <span>Strange Situation</span></em>. <span>New York</span>: <span>Psychology Press</span>. <a href="https://doi.org/10.4324/9780203758045">https://doi.org/10.4324/9780203758045</a>.
</div>
<div id="ref-bogaczPhysicsOptimalDecision2006" class="csl-entry" role="listitem">
Bogacz, Rafal, Eric Brown, Jeff Moehlis, Philip Holmes, and Jonathan D. Cohen. 2006. <span>“The Physics of Optimal Decision Making: <span>A</span> Formal Analysis of Models of Performance in Two-Alternative Forced-Choice Tasks.”</span> <em>Psychological Review</em> 113: 700–765. <a href="https://doi.org/10.1037/0033-295X.113.4.700">https://doi.org/10.1037/0033-295X.113.4.700</a>.
</div>
<div id="ref-bootIntegratingDualProcessInpreparation" class="csl-entry" role="listitem">
Boot, Jesse, Maarten van der Ende, Reinout W. Wiers, Mike Lees, and Han L. J. Van der Maas. submitted for publication. <span>“Integrating <span>Dual Process Decision-Making</span> and <span>Social Dynamics</span>: <span>A Formal Modeling Framework</span> for <span>Addiction</span>,”</span> submitted for publication.
</div>
<div id="ref-borsboomTheoryConstructionMethodology2021" class="csl-entry" role="listitem">
Borsboom, Denny, Han L. J. van der Maas, Jonas Dalege, Rogier A Kievit, and Brian D Haig. 2021. <span>“Theory <span>Construction Methodology</span>: <span>A Practical Framework</span> for <span>Building Theories</span> in <span>Psychology</span>.”</span> <em>Perspectives on Psychological Science</em> 16 (4): 756–66. <a href="https://doi.org/10.1177/1745691620969647">https://doi.org/10.1177/1745691620969647</a>.
</div>
<div id="ref-castroArtificialImmuneSystems2003" class="csl-entry" role="listitem">
Castro, L. N. de, and J. I. Timmis. 2003. <span>“Artificial Immune Systems as a Novel Soft Computing Paradigm.”</span> <em>Soft Computing</em> 7 (8): 526–44. <a href="https://doi.org/10.1007/s00500-002-0237-z">https://doi.org/10.1007/s00500-002-0237-z</a>.
</div>
<div id="ref-cattellIntelligenceItsStructure1987" class="csl-entry" role="listitem">
Cattell, R. B. 1987. <em>Intelligence: <span>Its Structure</span>, <span>Growth</span> and <span>Action</span></em>. <span>Elsevier</span>.
</div>
<div id="ref-clarkCognitiveApproachPanic1986" class="csl-entry" role="listitem">
Clark, David M. 1986. <span>“A Cognitive Approach to Panic.”</span> <em>Behaviour Research and Therapy</em> 24 (4): 461–70. <a href="https://doi.org/10.1016/0005-7967(86)90011-2">https://doi.org/10.1016/0005-7967(86)90011-2</a>.
</div>
<div id="ref-crielaardRefiningCausalLoop2022" class="csl-entry" role="listitem">
Crielaard, Loes, Jeroen F Uleman, Bas D L Châtel, Sacha Epskamp, Peter M A Sloot, and Rick Quax. 2022. <span>“Refining the Causal Loop Diagram: <span>A</span> Tutorial for Maximizing the Contribution of Domain Expertise in Computational System Dynamics Modeling.”</span> <em>Psychological Methods</em>, May. <a href="https://doi.org/10.1037/met0000484">https://doi.org/10.1037/met0000484</a>.
</div>
<div id="ref-daughertyMathematicalModelsBipolar2009" class="csl-entry" role="listitem">
Daugherty, Darryl, Tairi Roque-Urrea, John Urrea-Roque, Jessica Troyer, Stephen Wirkus, and Mason A. Porter. 2009. <span>“Mathematical Models of Bipolar Disorder.”</span> <em>Communications in Nonlinear Science and Numerical Simulation</em> 14 (7): 2897–2908. <a href="https://doi.org/10.1016/j.cnsns.2008.10.027">https://doi.org/10.1016/j.cnsns.2008.10.027</a>.
</div>
<div id="ref-deboerSimplePhasePlane2018" class="csl-entry" role="listitem">
de Boer, Rob J. 2018. <span>“Simple Phase Plane Analysis and Parameter Estimation in <span>R</span>,”</span> no. 20.
</div>
<div id="ref-dekkerCascadingTransitionsClimate2018" class="csl-entry" role="listitem">
Dekker, Mark M., Anna S. von der Heydt, and Henk A. Dijkstra. 2018. <span>“Cascading Transitions in the Climate System.”</span> <em>Earth System Dynamics</em> 9 (4): 1243–60. <a href="https://doi.org/10.5194/esd-9-1243-2018">https://doi.org/10.5194/esd-9-1243-2018</a>.
</div>
<div id="ref-denhartighDynamicNetworkModel2016" class="csl-entry" role="listitem">
Den Hartigh, Ruud J. R., Marijn W. G. Van Dijk, Henderien W. Steenbeek, and Paul L. C. Van Geert. 2016. <span>“A <span>Dynamic Network Model</span> to <span>Explain</span> the <span>Development</span> of <span>Excellent Human Performance</span>.”</span> <em>Frontiers in Psychology</em> 7. <a href="https://doi.org/10.3389/fpsyg.2016.00532">https://doi.org/10.3389/fpsyg.2016.00532</a>.
</div>
<div id="ref-vandongen2024" class="csl-entry" role="listitem">
Dongen, Noah N’Djaye Nikolai van, Riet van Bork, Adam Finnemann, Han L. J. van der Maas, Donald J. Robinaugh, Jonas Haslbeck, Jill de Ron, Jan Sprenger, and Denny Borsboom. 2024. <span>“Productive Explanation: A Framework for Evaluating Explanations in Psychological Scienc.”</span> <em>Psychologial Review</em>. <a href="https://doi.org/10.31234/osf.io/qd69g">https://doi.org/10.31234/osf.io/qd69g</a>.
</div>
<div id="ref-duckworth2014" class="csl-entry" role="listitem">
Duckworth, Angela, and James J. Gross. 2014. <span>“Self-Control and Grit: Related but Separable Determinants of Success.”</span> <em>Current Directions in Psychological Science</em> 23 (5): 319–25. <a href="https://doi.org/10.1177/0963721414541462">https://doi.org/10.1177/0963721414541462</a>.
</div>
<div id="ref-epskampIntermediateStableStates2022" class="csl-entry" role="listitem">
Epskamp, Sacha, Han L. J. van der Maas, Roseann E. Peterson, Hanna M. van Loo, Steven H. Aggen, and Kenneth S. Kendler. 2022. <span>“Intermediate Stable States in Substance Use.”</span> <em>Addictive Behaviors</em> 129 (June): 107252. <a href="https://doi.org/10.1016/j.addbeh.2022.107252">https://doi.org/10.1016/j.addbeh.2022.107252</a>.
</div>
<div id="ref-forgerSimplerModelHuman1999" class="csl-entry" role="listitem">
Forger, D B, M E Jewett, and R E Kronauer. 1999. <span>“A Simpler Model of the Human Circadian Pacemaker.”</span> <em>Journal of Biological Rhythms</em> 14 (6): 532–37. <a href="https://doi.org/10.1177/074873099129000867">https://doi.org/10.1177/074873099129000867</a>.
</div>
<div id="ref-forresterSystemDynamicsLessons1993" class="csl-entry" role="listitem">
Forrester, Jay W. 1993. <span>“System <span>Dynamics</span> and the <span>Lessons</span> of 35 <span>Years</span>.”</span> In <em>A <span>Systems-Based Approach</span> to <span>Policymaking</span></em>, edited by Kenyon B. De Greene, 199–240. <span>Boston, MA</span>: <span>Springer US</span>. <a href="https://doi.org/10.1007/978-1-4615-3226-2_7">https://doi.org/10.1007/978-1-4615-3226-2_7</a>.
</div>
<div id="ref-fortmann-roeInsightMakerGeneralpurpose2014" class="csl-entry" role="listitem">
Fortmann-Roe, Scott. 2014. <span>“Insight <span>Maker</span>: <span>A</span> General-Purpose Tool for Web-Based Modeling &amp; Simulation.”</span> <em>Simulation Modelling Practice and Theory</em> 47 (September): 28–45. <a href="https://doi.org/10.1016/j.simpat.2014.03.013">https://doi.org/10.1016/j.simpat.2014.03.013</a>.
</div>
<div id="ref-furstenauSimulatingBistablePerception2014" class="csl-entry" role="listitem">
Fürstenau, Norbert. 2014. <span>“Simulating Bistable Perception with Interrupted Ambiguous Stimulus Using Self-Oscillator Dynamics with Percept Choice Bifurcation.”</span> <em>Cognitive Processing</em> 15 (4): 467–90. <a href="https://doi.org/10.1007/s10339-014-0630-4">https://doi.org/10.1007/s10339-014-0630-4</a>.
</div>
<div id="ref-galeCollegeAdmissionsStability1962" class="csl-entry" role="listitem">
Gale, D., and L. S. Shapley. 1962. <span>“College <span>Admissions</span> and the <span>Stability</span> of <span>Marriage</span>.”</span> <em>The American Mathematical Monthly</em> 69 (1): 9–15. <a href="https://doi.org/10.2307/2312726">https://doi.org/10.2307/2312726</a>.
</div>
<div id="ref-gartnerThirdComponentCausing1990" class="csl-entry" role="listitem">
Gärtner, Klaus. 1990. <span>“A Third Component Causing Random Variability Beside Environment and Genotype. <span>A</span> Reason for the Limited Success of a 30 Year Long Effort to Standardize Laboratory Animals?”</span> <em>Laboratory Animals</em> 24 (1): 71–77. <a href="https://doi.org/10.1258/002367790780890347">https://doi.org/10.1258/002367790780890347</a>.
</div>
<div id="ref-gottmanMaritalProcessesPredictive1992" class="csl-entry" role="listitem">
Gottman, John M., and Robert W. Levenson. 1992. <span>“Marital Processes Predictive of Later Dissolution: <span>Behavior</span>, Physiology, and Health.”</span> <em>Journal of Personality and Social Psychology</em> 63: 221–33. <a href="https://doi.org/10.1037/0022-3514.63.2.221">https://doi.org/10.1037/0022-3514.63.2.221</a>.
</div>
<div id="ref-gottmanMathematicsMarriageDynamic2002" class="csl-entry" role="listitem">
Gottman, John M., James D. Murray, Catherine C. Swanson, Rebecca Tyson, and Kristin R. Swanson. 2002. <em>The Mathematics of Marriage: <span>Dynamic</span> Nonlinear Models</em>. The Mathematics of Marriage: <span>Dynamic</span> Nonlinear Models. <span>Cambridge, MA, US</span>: <span>MIT Press</span>.
</div>
<div id="ref-hamaker2009" class="csl-entry" role="listitem">
Hamaker, Ellen L., Zhiyong Zhang, and Han L. J. van&nbsp;der Maas. 2009. <span>“Using Threshold Autoregressive Models to&nbsp;Study Dyadic&nbsp;Interactions.”</span> <em>Psychometrika</em> 74 (4): 727–45. <a href="https://doi.org/10.1007/s11336-009-9113-4">https://doi.org/10.1007/s11336-009-9113-4</a>.
</div>
<div id="ref-hoffmannTeachableNeuralNetwork1986" class="csl-entry" role="listitem">
Hoffmann, Geoffrey W, Maurice W Benson, Geoffrey M Bree, and Paul E Kinahan. 1986. <span>“A Teachable Neural Network Based on an Unorthodox Neuron.”</span> <em>Physica D: Nonlinear Phenomena</em>, Proceedings of the <span>Fifth Annual International Conference</span>, 22 (1): 233–46. <a href="https://doi.org/10.1016/0167-2789(86)90243-5">https://doi.org/10.1016/0167-2789(86)90243-5</a>.
</div>
<div id="ref-izhikevichMultipleCuspBifurcations1This1998" class="csl-entry" role="listitem">
Izhikevich, Eugene M. 1998. <span>“Multiple Cusp <span class="nocase">bifurcations1This</span> Paper Received the <span>SIAM Award</span> as the Best Student Paper in Applied Mathematics in 1995. <span>It</span> Was Written While the Author Was a Graduate Student at Department of <span>Mathematics</span>, <span>Michigan State University</span>, and Was Supported in Part by <span>NSF</span> Grant <span>DMS</span> 9206677.<span>12This</span> Work Could Not Be Accomplished Without <span>Dr</span>. <span>Frank Hoppensteadt</span>. <span>I</span> Am Very Grateful for All Kinds of Investments He Made in Me and My Research.<span>23This</span> Paper Is Dedicated to <span>Frank C</span>. <span>Hoppensteadt</span> on the Occasion of His 60th Birthday.3.”</span> <em>Neural Networks</em> 11 (3): 495–508. <a href="https://doi.org/10.1016/S0893-6080(97)00117-2">https://doi.org/10.1016/S0893-6080(97)00117-2</a>.
</div>
<div id="ref-izhikevichFitzHughNagumoModel2006" class="csl-entry" role="listitem">
Izhikevich, Eugene M., and Richard FitzHugh. 2006. <span>“<span>FitzHugh-Nagumo</span> Model.”</span> <em>Scholarpedia</em> 1 (9): 1349. <a href="https://doi.org/10.4249/scholarpedia.1349">https://doi.org/10.4249/scholarpedia.1349</a>.
</div>
<div id="ref-johnsonModelingMultispeciesPredator2019" class="csl-entry" role="listitem">
Johnson, Chris J., Matthew A. Mumma, and Martin-Hugues St-Laurent. 2019. <span>“Modeling Multispecies Predatorprey Dynamics: Predicting the Outcomes of Conservation Actions for Woodland Caribou.”</span> <em>Ecosphere</em> 10 (3): e02622. <a href="https://doi.org/10.1002/ecs2.2622">https://doi.org/10.1002/ecs2.2622</a>.
</div>
<div id="ref-jusup2022" class="csl-entry" role="listitem">
Jusup, Marko, Petter Holme, Kiyoshi Kanazawa, Misako Takayasu, Ivan Romić, Zhen Wang, Sunčana Geček, et al. 2022. <span>“Social Physics.”</span> <em>Physics Reports</em>, Social physics, 948 (February): 1–148. <a href="https://doi.org/10.1016/j.physrep.2021.10.005">https://doi.org/10.1016/j.physrep.2021.10.005</a>.
</div>
<div id="ref-kloseEmergenceCascadingDynamics2020" class="csl-entry" role="listitem">
Klose, Ann Kristin, Volker Karle, Ricarda Winkelmann, and Jonathan F. Donges. 2020. <span>“Emergence of Cascading Dynamics in Interacting Tipping Elements of Ecology and Climate.”</span> <em>Royal Society Open Science</em> 7 (6): 200599. <a href="https://doi.org/10.1098/rsos.200599">https://doi.org/10.1098/rsos.200599</a>.
</div>
<div id="ref-ludwig1978" class="csl-entry" role="listitem">
Ludwig, D., D. D. Jones, and C. S. Holling. 1978. <span>“Qualitative Analysis of Insect Outbreak Systems: The Spruce Budworm and Forest.”</span> <em>Journal of Animal Ecology</em> 47 (1): 315–32. <a href="https://doi.org/10.2307/3939">https://doi.org/10.2307/3939</a>.
</div>
<div id="ref-mahmoudPolyaUrnModels2008" class="csl-entry" role="listitem">
Mahmoud, Hosam. 2008. <em>Polya <span>Urn Models</span></em>. <span>CRC Press</span>.
</div>
<div id="ref-meadowsThinkingSystemsPrimer2008" class="csl-entry" role="listitem">
Meadows, Donella H. 2008. <em>Thinking in <span>Systems</span>: <span>A Primer</span></em>. <span>Chelsea Green Publishing</span>.
</div>
<div id="ref-molenaar1993" class="csl-entry" role="listitem">
Molenaar, Peter C. M., Dorret I. Boomsma, and Conor V. Dolan. 1993. <span>“A Third Source of Developmental Differences.”</span> <em>Behavior Genetics</em> 23 (6): 519–24. <a href="https://doi.org/10.1007/BF01068142">https://doi.org/10.1007/BF01068142</a>.
</div>
<div id="ref-molenaarDynamicModelsDevelopment1985" class="csl-entry" role="listitem">
Molenaar, Peter C. M., and Louis Oppenheimer. 1985. <span>“Dynamic Models of Development and the Mechanistic-Organismic Controversy.”</span> <em>New Ideas in Psychology</em> 3 (3): 233–42. <a href="https://doi.org/10.1016/0732-118X(85)90017-0">https://doi.org/10.1016/0732-118X(85)90017-0</a>.
</div>
<div id="ref-monsivais-velazquezDynamicsHierarchicalWeighted2020" class="csl-entry" role="listitem">
Monsivais-Velazquez, Daniel, Kunal Bhattacharya, Rafael A. Barrio, Philip K. Maini, and Kimmo K. Kaski. 2020. <span>“Dynamics of Hierarchical Weighted Networks of van Der <span>Pol</span> Oscillators.”</span> <em>Chaos (Woodbury, N.Y.)</em> 30 (12): 123146. <a href="https://doi.org/10.1063/5.0010638">https://doi.org/10.1063/5.0010638</a>.
</div>
<div id="ref-murray1989" class="csl-entry" role="listitem">
Murray, James D. 1989. <em>Mathematical Biology</em>. Berlin, Heidelberg: Springer. <a href="https://doi.org/10.1007/978-3-662-08539-4">https://doi.org/10.1007/978-3-662-08539-4</a>.
</div>
<div id="ref-murrayMathematicalBiology2002" class="csl-entry" role="listitem">
———. 2002. <em>Mathematical Biology</em>. 3rd ed. Interdisciplinary Applied Mathematics. <span>New York</span>: <span>Springer</span>.
</div>
<div id="ref-rapoportFightsGamesDebates1960" class="csl-entry" role="listitem">
Rapoport, Anatol. 1960. <em>Fights, <span>Games</span>, and <span>Debates</span></em>. <span>University of Michigan Press</span>.
</div>
<div id="ref-ratcliffDiffusionDecisionModel2016" class="csl-entry" role="listitem">
Ratcliff, Roger, Philip L. Smith, Scott D. Brown, and Gail McKoon. 2016. <span>“Diffusion <span>Decision Model</span>: <span>Current Issues</span> and <span>History</span>.”</span> <em>Trends in Cognitive Sciences</em> 20 (4): 260–81. <a href="https://doi.org/10.1016/j.tics.2016.01.007">https://doi.org/10.1016/j.tics.2016.01.007</a>.
</div>
<div id="ref-remmerswaalImpairedSubjectiveSelfcontrol2019" class="csl-entry" role="listitem">
Remmerswaal, Danielle, Joran Jongerling, Pauline J. Jansen, Charly Eielts, and Ingmar H. A. Franken. 2019. <span>“Impaired Subjective Self-Control in Alcohol Use: <span>An</span> Ecological Momentary Assessment Study.”</span> <em>Drug and Alcohol Dependence</em> 204 (November): 107479. <a href="https://doi.org/10.1016/j.drugalcdep.2019.04.043">https://doi.org/10.1016/j.drugalcdep.2019.04.043</a>.
</div>
<div id="ref-rinaldiLoveDynamicsCase1998" class="csl-entry" role="listitem">
Rinaldi, Sergio. 1998. <span>“Love Dynamics: <span>The</span> Case of Linear Couples.”</span> <em>Applied Mathematics and Computation</em> 95 (2): 181–92. <a href="https://doi.org/10.1016/S0096-3003(97)10081-9">https://doi.org/10.1016/S0096-3003(97)10081-9</a>.
</div>
<div id="ref-robinaughAdvancingNetworkTheory2019" class="csl-entry" role="listitem">
Robinaugh, Donald J., Jonas Haslbeck, Lourens J. Waldorp, Jolanda Kossakowski, Eiko I. Fried, Alex Millner, Richard J. McNally, et al. 2019. <span>“Advancing the <span>Network Theory</span> of <span>Mental Disorders</span>: <span>A Computational Model</span> of <span>Panic Disorder</span>.”</span> <span>PsyArXiv</span>. <a href="https://doi.org/10.31234/osf.io/km37w">https://doi.org/10.31234/osf.io/km37w</a>.
</div>
<div id="ref-roxinNeurobiologicalModelsTwoChoice2008" class="csl-entry" role="listitem">
Roxin, Alex, and Anders Ledberg. 2008. <span>“Neurobiological <span>Models</span> of <span>Two-Choice Decision Making Can Be Reduced</span> to a <span>One-Dimensional Nonlinear Diffusion Equation</span>.”</span> <em>PLOS Computational Biology</em> 4 (3): e1000046. <a href="https://doi.org/10.1371/journal.pcbi.1000046">https://doi.org/10.1371/journal.pcbi.1000046</a>.
</div>
<div id="ref-saviWiringIntelligence2019" class="csl-entry" role="listitem">
Savi, Alexander O., Maarten Marsman, Han L. J. van der Maas, and Gunter K. J. Maris. 2019. <span>“The <span>Wiring</span> of <span>Intelligence</span>.”</span> <em>Perspectives on Psychological Science</em> 14 (6): 1034–61. <a href="https://doi.org/10.1177/1745691619866447">https://doi.org/10.1177/1745691619866447</a>.
</div>
<div id="ref-schonerDynamicThinkingPrimer2016" class="csl-entry" role="listitem">
Schöner, Gregor, and John P. Spencer. 2016. <em>Dynamic Thinking: <span>A</span> Primer on Dynamic Field Theory</em>. <span>Oxford University Press</span>.
</div>
<div id="ref-soetaert2010" class="csl-entry" role="listitem">
Soetaert, Karline, Thomas Petzoldt, and R. Woodrow Setzer. 2010. <span>“Solving Differential Equations in <span><em>R</em></span> : Package <span><strong>deSolve</strong></span>.”</span> <em>Journal of Statistical Software</em> 33 (9). <a href="https://doi.org/10.18637/jss.v033.i09">https://doi.org/10.18637/jss.v033.i09</a>.
</div>
<div id="ref-sprottDynamicalModelsLove2004" class="csl-entry" role="listitem">
Sprott, J. C. 2004. <span>“<a href="https://www.ncbi.nlm.nih.gov/pubmed/15233877">Dynamical Models of Love</a>.”</span> <em>Nonlinear Dynamics, Psychology, and Life Sciences</em> 8 (3): 303–14.
</div>
<div id="ref-strogatzLoveAffairsDifferential1988" class="csl-entry" role="listitem">
Strogatz, Steven H. 1988. <span>“Love <span>Affairs</span> and <span>Differential Equations</span>.”</span> <em>Mathematics Magazine</em> 61 (1): 35–35. <a href="https://doi.org/10.1080/0025570X.1988.11977342">https://doi.org/10.1080/0025570X.1988.11977342</a>.
</div>
<div id="ref-strogatzNonlinearDynamicsChaos2018" class="csl-entry" role="listitem">
———. 2018. <em>Nonlinear <span>Dynamics</span> and <span>Chaos</span> with <span>Student Solutions Manual</span>: <span>With Applications</span> to <span>Physics</span>, <span>Biology</span>, <span>Chemistry</span>, and <span>Engineering</span>, <span>Second Edition</span></em>. <span>CRC Press</span>.
</div>
<div id="ref-szostakHypercycle2016" class="csl-entry" role="listitem">
Szostak, Natalia, Szymon Wasik, and Jacek Blazewicz. 2016. <span>“Hypercycle.”</span> Edited by Shoshana Wodak. <em>PLOS Computational Biology</em> 12 (4): e1004853. <a href="https://doi.org/10.1371/journal.pcbi.1004853">https://doi.org/10.1371/journal.pcbi.1004853</a>.
</div>
<div id="ref-tschacher2019" class="csl-entry" role="listitem">
Tschacher, Wolfgang, and Hermann Haken. 2019. <em>The Process of Psychotherapy: Causation and Chance</em>. Springer.
</div>
<div id="ref-tuerlinckxComparisonFourMethods2001" class="csl-entry" role="listitem">
Tuerlinckx, Francis, Eric Maris, Roger Ratcliff, and Paul De Boeck. 2001. <span>“A Comparison of Four Methods for Simulating the Diffusion Process.”</span> <em>Behavior Research Methods, Instruments, &amp; Computers</em> 33 (4): 443–56. <a href="https://doi.org/10.3758/BF03195402">https://doi.org/10.3758/BF03195402</a>.
</div>
<div id="ref-tyutyunov2020" class="csl-entry" role="listitem">
Tyutyunov, Yu. V., and L. I. Titova. 2020. <span>“From Lotka<span></span>Volterra to Arditi<span></span>Ginzburg: 90 Years of Evolving Trophic Functions.”</span> <em>Biology Bulletin Reviews</em> 10 (3): 167–85. <a href="https://doi.org/10.1134/S207908642003007X">https://doi.org/10.1134/S207908642003007X</a>.
</div>
<div id="ref-vandenendeReviewMathematicalModeling2022" class="csl-entry" role="listitem">
van den Ende, Maarten W. J., Sacha Epskamp, Michael H. Lees, Han L. J. van der Maas, Reinout W. Wiers, and Peter M. A. Sloot. 2022. <span>“A Review of Mathematical Modeling of Addiction Regarding Both (Neuro-) Psychological Processes and the Social Contagion Perspectives.”</span> <em>Addictive Behaviors</em> 127 (April): 107201. <a href="https://doi.org/10.1016/j.addbeh.2021.107201">https://doi.org/10.1016/j.addbeh.2021.107201</a>.
</div>
<div id="ref-vangeertDynamicSystemsModel1991" class="csl-entry" role="listitem">
van Geert, Paul. 1991. <span>“A Dynamic Systems Model of Cognitive and Language Growth.”</span> <em>Psychological Review</em> 98: 3–53. <a href="https://doi.org/10.1037/0033-295X.98.1.3">https://doi.org/10.1037/0033-295X.98.1.3</a>.
</div>
<div id="ref-vangeertDynamicSystemsModel1998" class="csl-entry" role="listitem">
———. 1998. <span>“A Dynamic Systems Model of Basic Developmental Mechanisms: <span>Piaget</span>, <span>Vygotsky</span>, and Beyond.”</span> <em>Psychological Review</em> 105: 634–77. <a href="https://doi.org/10.1037/0033-295X.105.4.634-677">https://doi.org/10.1037/0033-295X.105.4.634-677</a>.
</div>
<div id="ref-verdonckIsingDecisionMaker2014" class="csl-entry" role="listitem">
Verdonck, Stijn, and Francis Tuerlinckx. 2014. <span>“The <span>Ising Decision Maker</span>: <span>A</span> Binary Stochastic Network for Choice Response Time.”</span> <em>Psychological Review</em> 121: 422–62. <a href="https://doi.org/10.1037/a0037012">https://doi.org/10.1037/a0037012</a>.
</div>
<div id="ref-vonderheydtCascadingTransitionsClimate2019" class="csl-entry" role="listitem">
von der Heydt, Anna, Mark Dekker, and Henk Dijkstra. 2019. <span>“Cascading Transitions in the Climate System,”</span> April, 10435.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The manual can be found at <a href="https://github.com/hansschepers/grindr/blob/master/inst/documentation/GRIND%20tutorial.pdf." class="uri">https://github.com/hansschepers/grindr/blob/master/inst/documentation/GRIND%20tutorial.pdf.</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In many texts <span class="math inline">\(\frac{dX}{dt}\)</span> is written as <span class="math inline">\(\dot{X}\)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The <span class="math inline">\(-X\)</span> is added because the difference equation has the form <span class="math inline">\(X_{t + 1} = f(X_{t})\)</span>, so the change <span class="math inline">\(dX\)</span> is thus <span class="math inline">\(f(X_{t})-X_{t}\)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="https://cran.r-project.org/web/packages/deBif/deBif.pdf" class="uri">https://cran.r-project.org/web/packages/deBif/deBif.pdf</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Simulating this model correctly is more difficult than one might expect. I refer to <span class="citation" data-cites="tuerlinckxComparisonFourMethods2001">Tuerlinckx et al. (<a href="references.html#ref-tuerlinckxComparisonFourMethods2001" role="doc-biblioref">2001</a>)</span> for a discussion of methods.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Difference equations were used in the original model because the data consist of turn takings in a conversation. This, however, does not lead to qualitative different results. With <code>method='euler'</code> and a change in <span class="math inline">\(r_{w}\)</span> and <span class="math inline">\(r_{h}\)</span> the difference model can be constructed.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>I follow the definition and notation of the original source, but this model is clearly not restricted to heterosexual relationships.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The rewriting is based on the Liénard transformation.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>The FitzHugh—Nagumo model is itself a simplified version of the famous Hodgkin—Huxley model, which consists of four differential equations and models the activation and deactivation dynamics of a spiking neuron in more detail.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>We could also use <span class="math inline">\(X_j^2\)</span>.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch3.html" class="pagination-link" aria-label="Transitions in complex systems">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Transitions in complex systems</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch5n.html" class="pagination-link" aria-label="Self-organization">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Self-organization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>